
> zephix-backend@1.0.0 test
> jest

FAIL src/modules/resources/resources.service.spec.ts (5.818 s)
  ● ResourcesService - detectConflicts › detectConflicts - Only HARD allocations › should compute only hardLoad when only HARD allocations exist

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - HARD plus SOFT › should compute both hardLoad and softLoad correctly

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - With thresholds › should classify as WARNING when total exceeds warningThreshold

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - With thresholds › should classify as CRITICAL when hardLoad exceeds criticalThreshold

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - With GHOST present › should exclude GHOST allocations from calculations

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - Without organization settings › should return NONE classification when organizationId not provided

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

FAIL src/modules/notifications/notifications-read-all.spec.ts (5.9 s)
  ● NotificationsService - Read All › Read-all makes unread-count go to 0 › should mark all notifications as read and return 0 unread count

    TypeError: this.notificationRepository.createQueryBuilder(...).where(...).andWhere(...).andWhere(...).getCount is not a function

      148 |         { userId },
      149 |       )
    > 150 |       .getCount();
          |        ^
      151 |
      152 |     return count;
      153 |   }

      at NotificationsService.getUnreadCount (modules/notifications/notifications.service.ts:150:8)
      at Object.<anonymous> (modules/notifications/notifications-read-all.spec.ts:77:47)

FAIL src/modules/workspaces/services/workspace-access.service.spec.ts (5.954 s)
  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_owner for platform ADMIN even without WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_owner for platform ADMIN with legacy role string

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_member for MEMBER with WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_viewer for VIEWER with WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return null for MEMBER with no WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return null for VIEWER with no WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return null if workspace belongs to different organization

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › hasWorkspaceRoleAtLeast › should return true when actual role satisfies required role

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › hasWorkspaceRoleAtLeast › should return false when actual role does not satisfy required role

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › hasWorkspaceRoleAtLeast › should return false for null actual role

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

FAIL src/modules/auth/auth-session-refresh.spec.ts (6.099 s)
  ● AuthService - Refresh Token Security › Refresh rotates token and old token fails › should rotate refresh token and reject old token

    REFRESH_TOKEN_PEPPER environment variable is required for refresh token hashing

      57 |   static hashRefreshToken(rawRefreshToken: string): string {
      58 |     if (!this.REFRESH_TOKEN_PEPPER) {
    > 59 |       throw new Error(
         |             ^
      60 |         'REFRESH_TOKEN_PEPPER environment variable is required for refresh token hashing',
      61 |       );
      62 |     }

      at TokenHashUtil.hashRefreshToken (common/security/token-hash.util.ts:59:13)
      at Object.<anonymous> (modules/auth/auth-session-refresh.spec.ts:118:37)

FAIL src/modules/workspaces/guards/require-org-role.guard.spec.ts
  ● Console

    console.log
      Guard role check, user role: ADMIN -> ADMIN, required: ADMIN -> ADMIN

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

    console.log
      Guard role check, user role: admin -> ADMIN, required: ADMIN -> ADMIN

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

    console.log
      Guard role check, user role: MEMBER -> MEMBER, required: ADMIN -> ADMIN

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

    console.log
      Guard role check, user role: MEMBER -> MEMBER, required: ADMIN -> ADMIN

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

    console.log
      Guard role check, user role: VIEWER -> VIEWER, required: ADMIN -> ADMIN

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

    console.log
      Guard role check, user role: ADMIN -> ADMIN, required: MEMBER -> MEMBER

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

    console.log
      Guard role check, user role: MEMBER -> MEMBER, required: MEMBER -> MEMBER

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

    console.log
      Guard role check, user role: VIEWER -> VIEWER, required: MEMBER -> MEMBER

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:48:15)

  ● RequireOrgRoleGuard › when no role requirement › should allow access

    ForbiddenException: Authentication required

      26 |
      27 |     if (!user) {
    > 28 |       throw new ForbiddenException('Authentication required');
         |             ^
      29 |     }
      30 |
      31 |     const requiredRole = this.reflector.get<string | PlatformRole>(

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:28:13)
      at Object.<anonymous> (modules/workspaces/guards/require-org-role.guard.spec.ts:29:28)

FAIL src/modules/work-management/services/task-dependencies.service.spec.ts (6.183 s)
  ● TaskDependenciesService › addDependency - cycle detection › should reject self-dependency

    Nest can't resolve dependencies of the TaskDependenciesService (TenantAwareRepository_WorkTaskDependency, TenantAwareRepository_WorkTask, TaskActivityService, TenantContextService, ?). Please make sure that the argument ProjectHealthService at index [4] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If ProjectHealthService is a provider, is it part of the current RootTestModule?
    - If ProjectHealthService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing ProjectHealthService */ ]
      })

      45 |     };
      46 |
    > 47 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      48 |       providers: [
      49 |         TaskDependenciesService,
      50 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 4)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-management/services/task-dependencies.service.spec.ts:47:35)

  ● TaskDependenciesService › addDependency - cycle detection › should detect cycle: A->B, B->C, then reject C->A

    Nest can't resolve dependencies of the TaskDependenciesService (TenantAwareRepository_WorkTaskDependency, TenantAwareRepository_WorkTask, TaskActivityService, TenantContextService, ?). Please make sure that the argument ProjectHealthService at index [4] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If ProjectHealthService is a provider, is it part of the current RootTestModule?
    - If ProjectHealthService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing ProjectHealthService */ ]
      })

      45 |     };
      46 |
    > 47 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      48 |       providers: [
      49 |         TaskDependenciesService,
      50 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 4)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-management/services/task-dependencies.service.spec.ts:47:35)

  ● TaskDependenciesService › addDependency - cycle detection › should return 409 CONFLICT for duplicate dependency

    Nest can't resolve dependencies of the TaskDependenciesService (TenantAwareRepository_WorkTaskDependency, TenantAwareRepository_WorkTask, TaskActivityService, TenantContextService, ?). Please make sure that the argument ProjectHealthService at index [4] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If ProjectHealthService is a provider, is it part of the current RootTestModule?
    - If ProjectHealthService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing ProjectHealthService */ ]
      })

      45 |     };
      46 |
    > 47 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      48 |       providers: [
      49 |         TaskDependenciesService,
      50 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 4)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-management/services/task-dependencies.service.spec.ts:47:35)

FAIL src/modules/resources/resource-allocation.service.spec.ts (6.146 s)
  ● ResourceAllocationService - validateGovernance › validateGovernance - No overlap dates › should not throw error when dates do not overlap

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Overlap below thresholds › should not throw error when projectedTotal is below hardCap and requireJustificationAbove

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Hard cap rule › should throw error when projectedTotal exceeds hardCap

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Justification rule › should throw error when projectedTotal exceeds requireJustificationAbove without justification

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Justification rule › should not throw error when projectedTotal exceeds requireJustificationAbove with justification

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Justification rule › should throw error when justification is empty string

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - GHOST exclusion › should exclude GHOST allocations from calculations

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

FAIL src/modules/integrations/integrations-webhook.controller.spec.ts
  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should return 202 with status "ignored" when webhookEnabled is false

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should return 202 with status "accepted" when webhookEnabled is true

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should throw BadRequestException if connection not found

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should return { data } format (no secrets)

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

FAIL src/admin/admin.controller.spec.ts
  ● AdminController - Contract Tests › GET /admin/stats › should return { data: Stats } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/stats › should return { data: Stats } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/health › should return { data: SystemHealth } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/health › should return { data: SystemHealth } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/org/summary › should return { data: OrgSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/org/summary › should return { data: OrgSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/users/summary › should return { data: UserSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/users/summary › should return { data: UserSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/workspaces/summary › should return { data: WorkspaceSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/workspaces/summary › should return { data: WorkspaceSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/risk/summary › should return { data: RiskSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/risk/summary › should return { data: RiskSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

PASS src/organizations/utils/resource-settings.util.spec.ts
PASS src/organizations/guards/organization.guard.spec.ts
[Nest] 55230  - 01/20/2026, 11:03:10 PM   ERROR [ArchitectureDerivationService] Architecture derivation failed for BRD: test-brd-id
[Nest] 55230  - 01/20/2026, 11:03:10 PM   ERROR [ArchitectureDerivationService] Error: LLM service unavailable
PASS src/modules/resources/services/resource-risk-score.service.spec.ts
[Nest] 55230  - 01/20/2026, 11:03:11 PM   ERROR [ArchitectureDerivationService] Architecture derivation failed for BRD: test-brd-id
[Nest] 55230  - 01/20/2026, 11:03:11 PM   ERROR [ArchitectureDerivationService] SyntaxError: Unexpected token 'i', "invalid js"... is not valid JSON
[Nest] 55230  - 01/20/2026, 11:03:11 PM   ERROR [ArchitectureDerivationService] Architecture derivation failed for BRD: test-brd-id
[Nest] 55230  - 01/20/2026, 11:03:11 PM   ERROR [ArchitectureDerivationService] Error: Network error
PASS src/architecture/architecture-derivation.service.spec.ts
PASS src/modules/integrations/services/external-task.service.spec.ts
PASS src/modules/tenancy/tenant-context.service.spec.ts
FAIL src/billing/billing.controller.spec.ts (6.732 s)
  ● BillingController - Contract Tests › GET /billing/plans › should return { data: [] } on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getPlans (billing/controllers/billing.controller.ts:50:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:101:22)

  ● BillingController - Contract Tests › GET /billing/subscription › should return { data: Subscription | null } format

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getSubscription (billing/controllers/billing.controller.ts:79:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:114:39)

  ● BillingController - Contract Tests › GET /billing/subscription › should return { data: null } when no subscription exists

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getSubscription (billing/controllers/billing.controller.ts:79:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:127:39)

  ● BillingController - Contract Tests › GET /billing/subscription › should return { data: null } on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getSubscription (billing/controllers/billing.controller.ts:79:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:137:39)

  ● BillingController - Contract Tests › GET /billing/current-plan › should return { data: CurrentPlan } format

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getCurrentPlan (billing/controllers/billing.controller.ts:109:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:149:39)

  ● BillingController - Contract Tests › GET /billing/current-plan › should return { data: Plan } on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getCurrentPlan (billing/controllers/billing.controller.ts:109:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:165:39)

  ● BillingController - Contract Tests › GET /billing/usage › should return { data: Usage } format

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getUsage (billing/controllers/billing.controller.ts:247:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:177:39)

  ● BillingController - Contract Tests › GET /billing/usage › should return safe defaults on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getUsage (billing/controllers/billing.controller.ts:247:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:192:39)

  ● BillingController - Contract Tests › POST /billing/subscribe › should return 403 for internalManaged organizations

    expect(received).rejects.toThrow(expected)

    Expected constructor: ForbiddenException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.subscribe (billing/controllers/billing.controller.ts:142:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:207:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:207:67)

  ● BillingController - Contract Tests › POST /billing/subscribe › should return 501 if not implemented

    expect(received).rejects.toThrow(expected)

    Expected constructor: NotImplementedException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.subscribe (billing/controllers/billing.controller.ts:142:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:216:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:216:67)

  ● BillingController - Contract Tests › PATCH /billing/subscription › should return 403 for internalManaged organizations when changing plan

    expect(received).rejects.toThrow(expected)

    Expected constructor: ForbiddenException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.updateSubscription (billing/controllers/billing.controller.ts:175:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:227:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:227:76)

  ● BillingController - Contract Tests › PATCH /billing/subscription › should return 501 if not implemented

    expect(received).rejects.toThrow(expected)

    Expected constructor: NotImplementedException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.updateSubscription (billing/controllers/billing.controller.ts:175:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:236:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:236:76)

  ● BillingController - Contract Tests › POST /billing/cancel › should return 403 for internalManaged organizations

    expect(received).rejects.toThrow(expected)

    Expected constructor: ForbiddenException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.cancelSubscription (billing/controllers/billing.controller.ts:205:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:246:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:246:71)

  ● BillingController - Contract Tests › POST /billing/cancel › should return 501 if not implemented

    expect(received).rejects.toThrow(expected)

    Expected constructor: NotImplementedException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.cancelSubscription (billing/controllers/billing.controller.ts:205:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:254:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:254:71)

PASS src/modules/integrations/integrations.controller.spec.ts
[Nest] 55229  - 01/20/2026, 11:03:11 PM   ERROR [LLMProviderService] LLM API request failed: 401 Unauthorized
{"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CXKwMSD5zgjY8nYoVUszg"}
[Nest] 55229  - 01/20/2026, 11:03:11 PM   ERROR [LLMProviderService] AI generation failed:
[Nest] 55229  - 01/20/2026, 11:03:11 PM   ERROR [LLMProviderService] Error: LLM API request failed: 401 Unauthorized
PASS src/ai/llm-provider.service.spec.ts
PASS src/modules/projects/dto/__tests__/create-project.dto.spec.ts
PASS src/modules/integrations/external-user-mappings.controller.spec.ts
PASS src/app.controller.spec.ts
PASS src/brd/controllers/brd-project-planning.controller.spec.ts
PASS src/common/http/get-auth-context.spec.ts
PASS src/common/utils/slug.util.spec.ts
PASS src/shared/guards/admin-only.guard.spec.ts
PASS src/modules/dashboards/services/dashboards.service.spec.ts
PASS src/shared/enums/platform-roles.enum.spec.ts
PASS src/shared/helpers/response.helper.spec.ts
PASS src/smoke-boot.spec.ts
PASS src/common/utils/commit-sha.resolver.spec.ts
PASS src/modules/workspaces/workspace-modules.controller.spec.ts
[Nest] 55231  - 01/20/2026, 11:03:11 PM   ERROR [IntegrationSyncService] Failed to process issue PROJ-456: Processing failed
Error: Processing failed
    at Object.<anonymous> (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/src/modules/integrations/services/integration-sync.service.spec.ts:200:32)
    at Promise.then.completed (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (<anonymous>)
    at callAsyncCircusFn (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/jest-runner/build/testWorker.js:106:12)
PASS src/modules/integrations/services/integration-sync.service.spec.ts
FAIL src/brd/validation/__tests__/brd-validation.service.spec.ts
  ● Test suite failed to run

    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m16[0m:[93m13[0m - [91merror[0m[90m TS2339: [0mProperty 'onModuleInit' does not exist on type 'BRDValidationService'.

    [7m16[0m     service.onModuleInit();
    [7m  [0m [91m            ~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m52[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m52[0m       expect(result.errors.some(e => e.path.includes('metadata'))).toBe(true);
    [7m  [0m [91m                                       ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m71[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m71[0m       expect(result.errors.some(e => e.message.includes('email'))).toBe(true);
    [7m  [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m86[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m86[0m       expect(result.errors.some(e => e.message.includes('Must be one of'))).toBe(true);
    [7m  [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m101[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m101[0m       expect(result.errors.some(e => e.message.includes('at least'))).toBe(true);
    [7m   [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m121[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m121[0m       expect(result.errors.some(e => e.message.includes('pattern'))).toBe(true);
    [7m   [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m136[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m136[0m       expect(result.errors.some(e => e.message.includes('no more than'))).toBe(true);
    [7m   [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m143[0m:[93m17[0m - [91merror[0m[90m TS2339: [0mProperty 'validateOrThrow' does not exist on type 'BRDValidationService'.

    [7m143[0m         service.validateOrThrow(seedData);
    [7m   [0m [91m                ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m155[0m:[93m17[0m - [91merror[0m[90m TS2339: [0mProperty 'validateOrThrow' does not exist on type 'BRDValidationService'.

    [7m155[0m         service.validateOrThrow(invalidPayload);
    [7m   [0m [91m                ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m174[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'isValid' does not exist on type 'ValidationSummary'.

    [7m174[0m       expect(summary.isValid).toBe(true);
    [7m   [0m [91m                     ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m175[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'errorCount' does not exist on type 'ValidationSummary'.

    [7m175[0m       expect(summary.errorCount).toBe(0);
    [7m   [0m [91m                     ~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m176[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'errorsBySection' does not exist on type 'ValidationSummary'.

    [7m176[0m       expect(summary.errorsBySection).toEqual({});
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m177[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'missingRequiredFields' does not exist on type 'ValidationSummary'. Did you mean 'missingRequired'?

    [7m177[0m       expect(summary.missingRequiredFields).toHaveLength(0);
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/brd/validation/brd-validation.service.ts[0m:[93m14[0m:[93m3[0m
        [7m14[0m   missingRequired: string[];
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'missingRequired' is declared here.
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m199[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'isValid' does not exist on type 'ValidationSummary'.

    [7m199[0m       expect(summary.isValid).toBe(false);
    [7m   [0m [91m                     ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m200[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'errorCount' does not exist on type 'ValidationSummary'.

    [7m200[0m       expect(summary.errorCount).toBeGreaterThan(0);
    [7m   [0m [91m                     ~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m201[0m:[93m34[0m - [91merror[0m[90m TS2339: [0mProperty 'errorsBySection' does not exist on type 'ValidationSummary'.

    [7m201[0m       expect(Object.keys(summary.errorsBySection).length).toBeGreaterThan(0);
    [7m   [0m [91m                                 ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m202[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'missingRequiredFields' does not exist on type 'ValidationSummary'. Did you mean 'missingRequired'?

    [7m202[0m       expect(summary.missingRequiredFields.length).toBeGreaterThan(0);
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/brd/validation/brd-validation.service.ts[0m:[93m14[0m:[93m3[0m
        [7m14[0m   missingRequired: string[];
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'missingRequired' is declared here.
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m219[0m:[93m31[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m219[0m       expect(result.errors[0].path).toBe('metadata.title');
    [7m   [0m [91m                              ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m237[0m:[93m52[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m237[0m       const titleError = result.errors.find(e => e.path.includes('functionalRequirements') && e.path.includes('title'));
    [7m   [0m [91m                                                   ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m237[0m:[93m97[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m237[0m       const titleError = result.errors.find(e => e.path.includes('functionalRequirements') && e.path.includes('title'));
    [7m   [0m [91m                                                                                                ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m239[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m239[0m       expect(titleError?.path).toMatch(/functionalRequirements\.\d+\.title/);
    [7m   [0m [91m                         ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m272[0m:[93m63[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m272[0m         expect(result.errors.some(e => expectedMessage.test(e.message))).toBe(true);
    [7m   [0m [91m                                                              ~~~~~~~[0m

FAIL src/modules/templates/controllers/templates.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m66[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m66[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, mockUser, req);
    [7m  [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m80[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m80[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, mockUser, req);
    [7m  [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m91[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m91[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, mockUser, req);
    [7m  [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m100[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m100[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, undefined, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m113[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findOne' does not exist on type 'TemplatesController'.

    [7m113[0m       const result = await controller.findOne('test-template-id', mockUser, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m126[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findOne' does not exist on type 'TemplatesController'.

    [7m126[0m       const result = await controller.findOne('non-existent-id', mockUser, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m136[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findOne' does not exist on type 'TemplatesController'.

    [7m136[0m       const result = await controller.findOne('test-template-id', mockUser, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m159[0m:[93m91[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m159[0m       const result = await controller.instantiate('test-template-id', validDto, mockUser, req);
    [7m   [0m [91m                                                                                          ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m162[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m162[0m       expect(result.data).toHaveProperty('projectId');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m163[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m163[0m       expect(result.data).toHaveProperty('name');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m164[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m164[0m       expect(result.data).toHaveProperty('workspaceId');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m165[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m165[0m       expect(result.data.projectId).toBe('test-project-id');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m172[0m:[93m85[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m172[0m       await expect(controller.instantiate('test-template-id', invalidDto, mockUser, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                    ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m175[0m:[93m80[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m175[0m         await controller.instantiate('test-template-id', invalidDto, mockUser, req);
    [7m   [0m [91m                                                                               ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m186[0m:[93m85[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m186[0m       await expect(controller.instantiate('test-template-id', invalidDto, mockUser, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                    ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m189[0m:[93m80[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m189[0m         await controller.instantiate('test-template-id', invalidDto, mockUser, req);
    [7m   [0m [91m                                                                               ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m200[0m:[93m89[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m200[0m       await expect(controller.instantiate('test-template-id', validDto, userWithoutOrg, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                        ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m203[0m:[93m84[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m203[0m         await controller.instantiate('test-template-id', validDto, userWithoutOrg, req);
    [7m   [0m [91m                                                                                   ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m214[0m:[93m82[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m214[0m       await expect(controller.instantiate('non-existent-id', validDto, mockUser, req)).rejects.toThrow(NotFoundException);
    [7m   [0m [91m                                                                                 ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m221[0m:[93m83[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m221[0m       await expect(controller.instantiate('test-template-id', validDto, mockUser, req)).rejects.toThrow(ForbiddenException);
    [7m   [0m [91m                                                                                  ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m228[0m:[93m83[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m228[0m       await expect(controller.instantiate('test-template-id', validDto, mockUser, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                  ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m231[0m:[93m78[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m231[0m         await controller.instantiate('test-template-id', validDto, mockUser, req);
    [7m   [0m [91m                                                                             ~~~[0m

FAIL src/workflows/__tests__/workflow-templates.service.spec.ts
  ● Test suite failed to run

    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m136[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'approvals' does not exist in type 'CreateWorkflowStageDto'.

    [7m136[0m           approvals: [
    [7m   [0m [91m          ~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m268[0m:[93m36[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m268[0m       const result = await service.getWorkflowTemplates(organizationId);
    [7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m287[0m:[93m21[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m287[0m       await service.getWorkflowTemplates(
    [7m   [0m [91m                    ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m317[0m:[93m36[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplateById' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m317[0m       const result = await service.getWorkflowTemplateById(templateId, organizationId);
    [7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m327[0m:[93m17[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplateById' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m327[0m         service.getWorkflowTemplateById(templateId, organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m397[0m:[93m21[0m - [91merror[0m[90m TS2554: [0mExpected 3 arguments, but got 2.

    [7m397[0m       await service.deleteWorkflowTemplate(templateId, organizationId);
    [7m   [0m [91m                    ~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m268[0m:[93m5[0m
        [7m268[0m     userId: string,
        [7m   [0m [96m    ~~~~~~~~~~~~~~[0m
        An argument for 'userId' was not provided.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m415[0m:[93m17[0m - [91merror[0m[90m TS2554: [0mExpected 3 arguments, but got 2.

    [7m415[0m         service.deleteWorkflowTemplate(templateId, organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m268[0m:[93m5[0m
        [7m268[0m     userId: string,
        [7m   [0m [96m    ~~~~~~~~~~~~~~[0m
        An argument for 'userId' was not provided.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m429[0m:[93m17[0m - [91merror[0m[90m TS2554: [0mExpected 3 arguments, but got 2.

    [7m429[0m         service.deleteWorkflowTemplate(templateId, organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m268[0m:[93m5[0m
        [7m268[0m     userId: string,
        [7m   [0m [96m    ~~~~~~~~~~~~~~[0m
        An argument for 'userId' was not provided.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m475[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m475[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockOriginalTemplate as any);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m475[0m:[93m54[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m475[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockOriginalTemplate as any);
    [7m   [0m [91m                                                     ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m480[0m:[93m36[0m - [91merror[0m[90m TS2551: [0mProperty 'cloneWorkflowTemplate' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m480[0m       const result = await service.cloneWorkflowTemplate(
    [7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m561[0m:[93m17[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m561[0m         service.getWorkflowTemplates(organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m572[0m:[93m23[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m572[0m         await service.getWorkflowTemplates(organizationId);
    [7m   [0m [91m                      ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.

FAIL src/modules/projects/controllers/projects.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m8[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../app.module' or its corresponding type declarations.

    [7m8[0m import { AppModule } from '../../app.module';
    [7m [0m [91m                          ~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m10[0m:[93m22[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/team.entity' or its corresponding type declarations.

    [7m10[0m import { Team } from '../entities/team.entity';
    [7m  [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m11[0m:[93m28[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/team-member.entity' or its corresponding type declarations.

    [7m11[0m import { TeamMember } from '../entities/team-member.entity';
    [7m  [0m [91m                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m12[0m:[93m32[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/role.entity' or its corresponding type declarations.

    [7m12[0m import { Role, RoleType } from '../entities/role.entity';
    [7m  [0m [91m                               ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m13[0m:[93m22[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../modules/users/entities/user.entity' or its corresponding type declarations.

    [7m13[0m import { User } from "../../modules/users/entities/user.entity"
    [7m  [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m107[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'workspaceId' is missing in type '{ name: string; description: string; status: any; priority: any; }' but required in type 'CreateProjectDto'.

    [7m107[0m     const createProjectDto: CreateProjectDto = {
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m

      [96msrc/modules/projects/dto/create-project.dto.ts[0m:[93m48[0m:[93m3[0m
        [7m48[0m   workspaceId: string;
        [7m  [0m [96m  ~~~~~~~~~~~[0m
        'workspaceId' is declared here.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m115[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m115[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m145[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m145[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m157[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m157[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m170[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m170[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m181[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m181[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m212[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m212[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m229[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m229[0m       await request(app.getHttpServer()).get('/api/projects').expect(401);
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m247[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m247[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m260[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m260[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m291[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m291[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m307[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m307[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m328[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m328[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m335[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m335[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m344[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m344[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m381[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m381[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m411[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m411[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m423[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m423[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m433[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m433[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m464[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m464[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m473[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m473[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m480[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m480[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m489[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m489[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m534[0m:[93m32[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m534[0m         const response = await request(app.getHttpServer())
    [7m   [0m [91m                               ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m553[0m:[93m15[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m553[0m         await request(app.getHttpServer())
    [7m   [0m [91m              ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m567[0m:[93m32[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m567[0m         const response = await request(app.getHttpServer())
    [7m   [0m [91m                               ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m584[0m:[93m15[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m584[0m         await request(app.getHttpServer())
    [7m   [0m [91m              ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL src/modules/templates/services/templates.service.spec.ts
  ● Test suite failed to run

    [96msrc/modules/templates/services/templates.service.spec.ts[0m:[93m113[0m:[93m9[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' to type 'TemplateBlock' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'TemplateBlock': template, block

    [7m113[0m         {
    [7m   [0m [91m        ~[0m
    [7m114[0m           id: 'tb-1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m123[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m124[0m         } as TemplateBlock,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/templates/services/templates.service.spec.ts[0m:[93m125[0m:[93m9[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' to type 'TemplateBlock' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'TemplateBlock': template, block

    [7m125[0m         {
    [7m   [0m [91m        ~[0m
    [7m126[0m           id: 'tb-2',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m135[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m136[0m         } as TemplateBlock,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/templates/services/templates.service.spec.ts[0m:[93m160[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'id' does not exist on type 'Template[]'.

    [7m160[0m       expect(result.id).toBe('cloned-template-123');
    [7m   [0m [91m                    ~~[0m

FAIL src/workflows/__tests__/workflow-templates.controller.spec.ts
  ● Test suite failed to run

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m155[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'approvals' does not exist in type 'CreateWorkflowStageDto'.

    [7m155[0m           approvals: [
    [7m   [0m [91m          ~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m192[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: WorkflowStatus; version: number; isDefault: boolean; isPublic: boolean; usageCount: number; tags: any[]; metadata: {}; organizationId: string; createdBy: string; createdAt: Date; ... 6 more ...; id: string; }' is not assignable to parameter of type 'WorkflowTemplate | Promise<WorkflowTemplate>'.
      Type '{ status: WorkflowStatus; version: number; isDefault: boolean; isPublic: boolean; usageCount: number; tags: any[]; metadata: {}; organizationId: string; createdBy: string; createdAt: Date; ... 6 more ...; id: string; }' is missing the following properties from type 'WorkflowTemplate': lastUsedAt, deletedAt, organization, creator, and 5 more.

    [7m192[0m       jest.spyOn(service, 'createWorkflowTemplate').mockResolvedValue(mockCreatedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m246[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m246[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m246[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m246[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m255[0m:[93m9[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m255[0m         1, // page
    [7m   [0m [91m        ~~~~~~~~~~[0m
    [7m256[0m         20 // limit
    [7m   [0m [91m~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m262[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m262[0m       expect(service.getWorkflowTemplates).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m283[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m283[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m283[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m283[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m292[0m:[93m9[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m292[0m         1,
    [7m   [0m [91m        ~~[0m
    [7m293[0m         10
    [7m   [0m [91m~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m296[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m296[0m       expect(service.getWorkflowTemplates).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m318[0m:[93m11[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m318[0m           0, // Invalid page
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~~~[0m
    [7m319[0m           20
    [7m   [0m [91m~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m332[0m:[93m11[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m332[0m           1,
    [7m   [0m [91m          ~~[0m
    [7m333[0m           0 // Invalid limit
    [7m   [0m [91m~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m345[0m:[93m11[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m345[0m           1,
    [7m   [0m [91m          ~~[0m
    [7m346[0m           101 // Invalid limit
    [7m   [0m [91m~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m367[0m:[93m67[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; isDefault: boolean; status: WorkflowStatus; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; name: string; isDefault: boolean; status: WorkflowStatus; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': description, type, version, usageCount, and 2 more.

    [7m367[0m       jest.spyOn(service, 'getDefaultTemplate').mockResolvedValue(mockDefaultTemplate);
    [7m   [0m [91m                                                                  ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m399[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m399[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockTemplate);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m399[0m:[93m54[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m399[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockTemplate);
    [7m   [0m [91m                                                     ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m405[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplateById' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m405[0m       expect(service.getWorkflowTemplateById).toHaveBeenCalledWith(templateId, 'org-123');
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m409[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m409[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockRejectedValue(
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m409[0m:[93m54[0m - [91merror[0m[90m TS2339: [0mProperty 'mockRejectedValue' does not exist on type 'never'.

    [7m409[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockRejectedValue(
    [7m   [0m [91m                                                     ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m438[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; description: string; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; name: string; description: string; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': type, status, isDefault, version, and 3 more.

    [7m438[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockUpdatedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m508[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m508[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m508[0m:[93m52[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m508[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                                                   ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m512[0m:[93m9[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ newName: string; }' is not assignable to parameter of type 'CloneTemplateDto'.
      Property 'name' is missing in type '{ newName: string; }' but required in type 'CloneTemplateDto'.

    [7m512[0m         cloneBody,
    [7m   [0m [91m        ~~~~~~~~~[0m

      [96msrc/workflows/dto/workflow.dto.ts[0m:[93m467[0m:[93m3[0m
        [7m467[0m   name: string;
        [7m   [0m [96m  ~~~~[0m
        'name' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m518[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'cloneWorkflowTemplate' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m518[0m       expect(service.cloneWorkflowTemplate).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m533[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m533[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m533[0m:[93m52[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m533[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                                                   ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m537[0m:[93m9[0m - [91merror[0m[90m TS2345: [0mArgument of type '{}' is not assignable to parameter of type 'CloneTemplateDto'.
      Property 'name' is missing in type '{}' but required in type 'CloneTemplateDto'.

    [7m537[0m         {},
    [7m   [0m [91m        ~~[0m

      [96msrc/workflows/dto/workflow.dto.ts[0m:[93m467[0m:[93m3[0m
        [7m467[0m   name: string;
        [7m   [0m [96m  ~~~~[0m
        'name' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m542[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'cloneWorkflowTemplate' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m542[0m       expect(service.cloneWorkflowTemplate).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m565[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; status: WorkflowStatus; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; status: WorkflowStatus; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': name, description, type, isDefault, and 4 more.

    [7m565[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockActivatedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m594[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; status: WorkflowStatus; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; status: WorkflowStatus; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': name, description, type, isDefault, and 4 more.

    [7m594[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockArchivedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m623[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; isDefault: boolean; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; isDefault: boolean; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': name, description, type, status, and 4 more.

    [7m623[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockDefaultTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m625[0m:[93m39[0m - [91merror[0m[90m TS2551: [0mProperty 'setAsDefaultTemplate' does not exist on type 'WorkflowTemplatesController'. Did you mean 'getDefaultTemplate'?

    [7m625[0m       const result = await controller.setAsDefaultTemplate(templateId, mockRequest as any);
    [7m   [0m [91m                                      ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/controllers/workflow-templates.controller.ts[0m:[93m155[0m:[93m9[0m
        [7m155[0m   async getDefaultTemplate(
        [7m   [0m [96m        ~~~~~~~~~~~~~~~~~~[0m
        'getDefaultTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m655[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m655[0m       jest.spyOn(service, 'getWorkflowTemplates').mockRejectedValue(
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m655[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'mockRejectedValue' does not exist on type 'never'.

    [7m655[0m       jest.spyOn(service, 'getWorkflowTemplates').mockRejectedValue(
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~~[0m

FAIL src/modules/workspaces/workspaces.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/workspaces/workspaces.controller.spec.ts[0m:[93m309[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'ownerId' does not exist on type '{ workspaceId: string; }'.

    [7m309[0m       expect(result.data.ownerId).toBe(memberUserId);
    [7m   [0m [91m                         ~~~~~~~[0m

FAIL src/modules/home/home.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/home/home.integration.spec.ts[0m:[93m234[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m234[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m282[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m282[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m308[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m308[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m320[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m320[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m340[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m340[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL src/modules/auth/auth.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m24[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m24[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m41[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m41[0m       await request(app.getHttpServer())
    [7m  [0m [91m            ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m56[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m56[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m69[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m69[0m       await request(app.getHttpServer())
    [7m  [0m [91m            ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m80[0m:[93m15[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m80[0m         await request(app.getHttpServer())
    [7m  [0m [91m              ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m88[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m88[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL src/modules/auth/auth.routes.spec.ts
  ● Test suite failed to run

    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m32[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m32[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m49[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m49[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m64[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m64[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m82[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m82[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m99[0m:[93m38[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m99[0m       const registerResponse = await request(app.getHttpServer())
    [7m  [0m [91m                                     ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m103[0m:[93m36[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m103[0m       const signupResponse = await request(app.getHttpServer())
    [7m   [0m [91m                                   ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL src/modules/projects/projects.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m50[0m:[93m20[0m - [91merror[0m[90m TS2740: [0mType '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m50[0m         projects: [mockProject],
    [7m  [0m [91m                   ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m100[0m:[93m72[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m100[0m       jest.spyOn(projectsService, 'findProjectById').mockResolvedValue(mockProject);
    [7m   [0m [91m                                                                       ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m170[0m:[93m70[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m170[0m       jest.spyOn(projectsService, 'createProject').mockResolvedValue(mockProject);
    [7m   [0m [91m                                                                     ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m204[0m:[93m72[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m204[0m       jest.spyOn(projectsService, 'findProjectById').mockResolvedValue(mockProject);
    [7m   [0m [91m                                                                       ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m205[0m:[93m70[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ name: string; id: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ name: string; id: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m205[0m       jest.spyOn(projectsService, 'updateProject').mockResolvedValue({ ...mockProject, name: 'Updated' });
    [7m   [0m [91m                                                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/modules/work-items/my-work.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m82[0m:[93m5[0m - [91merror[0m[90m TS2740: [0mType 'User[]' is missing the following properties from type 'User': id, email, password, firstName, and 20 more.

    [7m82[0m     adminUser = await userRepo.save(
    [7m  [0m [91m    ~~~~~~~~~[0m
    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m83[0m:[93m16[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<User>[]): User[]', gave the following error.
        Object literal may only specify known properties, and 'email' does not exist in type 'DeepPartial<User>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<User>): User', gave the following error.
        Object literal may only specify known properties, and 'platformRole' does not exist in type 'DeepPartial<User>'.

    [7m83[0m       userRepo.create({
    [7m  [0m [91m               ~~~~~~[0m

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m92[0m:[93m5[0m - [91merror[0m[90m TS2740: [0mType 'User[]' is missing the following properties from type 'User': id, email, password, firstName, and 20 more.

    [7m92[0m     memberUser = await userRepo.save(
    [7m  [0m [91m    ~~~~~~~~~~[0m
    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m93[0m:[93m16[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<User>[]): User[]', gave the following error.
        Object literal may only specify known properties, and 'email' does not exist in type 'DeepPartial<User>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<User>): User', gave the following error.
        Object literal may only specify known properties, and 'platformRole' does not exist in type 'DeepPartial<User>'.

    [7m93[0m       userRepo.create({
    [7m  [0m [91m               ~~~~~~[0m

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m102[0m:[93m5[0m - [91merror[0m[90m TS2740: [0mType 'User[]' is missing the following properties from type 'User': id, email, password, firstName, and 20 more.

    [7m102[0m     guestUser = await userRepo.save(
    [7m   [0m [91m    ~~~~~~~~~[0m
    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m103[0m:[93m16[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<User>[]): User[]', gave the following error.
        Object literal may only specify known properties, and 'email' does not exist in type 'DeepPartial<User>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<User>): User', gave the following error.
        Object literal may only specify known properties, and 'platformRole' does not exist in type 'DeepPartial<User>'.

    [7m103[0m       userRepo.create({
    [7m   [0m [91m               ~~~~~~[0m

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m133[0m:[93m18[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<WorkspaceMember>[]): WorkspaceMember[]', gave the following error.
        Object literal may only specify known properties, and 'workspaceId' does not exist in type 'DeepPartial<WorkspaceMember>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<WorkspaceMember>): WorkspaceMember', gave the following error.
        Object literal may only specify known properties, and 'organizationId' does not exist in type 'DeepPartial<WorkspaceMember>'.

    [7m133[0m       memberRepo.create({
    [7m   [0m [91m                 ~~~~~~[0m

FAIL src/brd/services/__tests__/brd.service.spec.ts
  ● Test suite failed to run

    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m26[0m:[93m5[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'isEditable' does not exist in type 'BRD'.

    [7m26[0m     isEditable: jest.fn(),
    [7m  [0m [91m    ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m114[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType '{ path: string; message: string; }' is not assignable to type 'string'.

    [7m114[0m           {
    [7m   [0m [91m          ~[0m
    [7m115[0m             path: 'metadata.title',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m116[0m             message: 'Missing required field: title',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m117[0m           },
    [7m   [0m [91m~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m139[0m:[93m15[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m139[0m       mockBRD.isEditable = jest.fn().mockReturnValue(true);
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m147[0m:[93m41[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ version: number; payload: { metadata: { title: string; summary: string; industry: string; department: string; priority: string; version: string; author: string; stakeholders: string[]; approvalDate: string; }; ... 4 more ...; timeline: { ...; }; }; ... 7 more ...; analyses: BRDAnalysis[]; }' is not assignable to parameter of type '(DeepPartial<BRD> & BRD) | Promise<DeepPartial<BRD> & BRD>'.
      Type '{ version: number; payload: { metadata: { title: string; summary: string; industry: string; department: string; priority: string; version: string; author: string; stakeholders: string[]; approvalDate: string; }; ... 4 more ...; timeline: { ...; }; }; ... 7 more ...; analyses: BRDAnalysis[]; }' is not assignable to type '{ id?: string; organizationId?: string; project_id?: string; version?: number; status?: DeepPartial<BRDStatus>; payload?: DeepPartial<Record<string, any>>; ... 13 more ...; updateSearchVector?: DeepPartial<...>; } & BRD'.
        Type '{ version: number; payload: { metadata: { title: string; summary: string; industry: string; department: string; priority: string; version: string; author: string; stakeholders: string[]; approvalDate: string; }; ... 4 more ...; timeline: { ...; }; }; ... 7 more ...; analyses: BRDAnalysis[]; }' is missing the following properties from type 'BRD': getTitle, getSummary, getIndustry, getDepartment, and 6 more.

    [7m147[0m       repository.save.mockResolvedValue(updatedBRD);
    [7m   [0m [91m                                        ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m154[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m154[0m       expect(mockBRD.isEditable).toHaveBeenCalled();
    [7m   [0m [91m                     ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m177[0m:[93m15[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m177[0m       mockBRD.isEditable = jest.fn().mockReturnValue(false);
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m188[0m:[93m15[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m188[0m       mockBRD.isEditable = jest.fn().mockReturnValue(true);
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m192[0m:[93m18[0m - [91merror[0m[90m TS2322: [0mType '{ path: string; message: string; }' is not assignable to type 'string'.

    [7m192[0m         errors: [{ path: 'metadata.title', message: 'Missing required field: title' }],
    [7m   [0m [91m                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m252[0m:[93m41[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: BRDStatus.APPROVED; id: string; organizationId: string; project_id: string | null; version: number; payload: Record<string, any>; search_vector: string | null; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is not assignable to parameter of type '(DeepPartial<BRD> & BRD) | Promise<DeepPartial<BRD> & BRD>'.
      Type '{ status: BRDStatus.APPROVED; id: string; organizationId: string; project_id: string | null; version: number; payload: Record<string, any>; search_vector: string | null; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is not assignable to type '{ id?: string; organizationId?: string; project_id?: string; version?: number; status?: DeepPartial<BRDStatus>; payload?: DeepPartial<Record<string, any>>; ... 13 more ...; updateSearchVector?: DeepPartial<...>; } & BRD'.
        Type '{ status: BRDStatus.APPROVED; id: string; organizationId: string; project_id: string; version: number; payload: Record<string, any>; search_vector: string; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is missing the following properties from type 'BRD': getTitle, getSummary, getIndustry, getDepartment, and 6 more.

    [7m252[0m       repository.save.mockResolvedValue({ ...mockBRD, status: BRDStatus.APPROVED });
    [7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m254[0m:[93m65[0m - [91merror[0m[90m TS2554: [0mExpected 2 arguments, but got 3.

    [7m254[0m       await service.publish(mockBRD.id, mockBRD.organizationId, publishDto);
    [7m   [0m [91m                                                                ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m268[0m:[93m72[0m - [91merror[0m[90m TS2554: [0mExpected 2 arguments, but got 3.

    [7m268[0m       await expect(service.publish(mockBRD.id, mockBRD.organizationId, publishDto)).rejects.toThrow(
    [7m   [0m [91m                                                                       ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m280[0m:[93m18[0m - [91merror[0m[90m TS2322: [0mType '{ path: string; message: string; }' is not assignable to type 'string'.

    [7m280[0m         errors: [{ path: 'metadata.title', message: 'Missing required field: title' }],
    [7m   [0m [91m                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m285[0m:[93m72[0m - [91merror[0m[90m TS2554: [0mExpected 2 arguments, but got 3.

    [7m285[0m       await expect(service.publish(mockBRD.id, mockBRD.organizationId, publishDto)).rejects.toThrow(
    [7m   [0m [91m                                                                       ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m307[0m:[93m44[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: BRDStatus; id: string; organizationId: string; project_id: string | null; version: number; payload: Record<string, any>; search_vector: string | null; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is not assignable to parameter of type 'BRD | Promise<BRD>'.
      Type '{ status: BRDStatus; id: string; organizationId: string; project_id: string; version: number; payload: Record<string, any>; search_vector: string; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is missing the following properties from type 'BRD': getTitle, getSummary, getIndustry, getDepartment, and 6 more.

    [7m307[0m       repository.findOne.mockResolvedValue(publishedBRD);
    [7m   [0m [91m                                           ~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m335[0m:[93m53[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ where: jest.Mock<any, any, any>; andWhere: jest.Mock<any, any, any>; getCount: jest.Mock<any, any, any>; skip: jest.Mock<any, any, any>; take: jest.Mock<any, any, any>; orderBy: jest.Mock<...>; getMany: jest.Mock<...>; }' is not assignable to parameter of type 'SelectQueryBuilder<BRD>'.
      Type '{ where: Mock<any, any, any>; andWhere: Mock<any, any, any>; getCount: Mock<any, any, any>; skip: Mock<any, any, any>; take: Mock<any, any, any>; orderBy: Mock<...>; getMany: Mock<...>; }' is missing the following properties from type 'SelectQueryBuilder<BRD>': "@instanceof", findOptions, selects, joins, and 135 more.

    [7m335[0m       repository.createQueryBuilder.mockReturnValue(mockQueryBuilder);
    [7m   [0m [91m                                                    ~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m371[0m:[93m62[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ isValid: boolean; errorCount: number; errorsBySection: {}; missingRequiredFields: any[]; }' is not assignable to parameter of type 'ValidationSummary'.
      Type '{ isValid: boolean; errorCount: number; errorsBySection: {}; missingRequiredFields: any[]; }' is missing the following properties from type 'ValidationSummary': totalFields, completedFields, completionPercentage, missingRequired, validationErrors

    [7m371[0m       validationService.getValidationSummary.mockReturnValue(mockSummary);
    [7m   [0m [91m                                                             ~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m389[0m:[93m30[0m - [91merror[0m[90m TS2339: [0mProperty 'getSchema' does not exist on type 'BRDService'.

    [7m389[0m       const result = service.getSchema();
    [7m   [0m [91m                             ~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m407[0m:[93m53[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ where: jest.Mock<any, any, any>; andWhere: jest.Mock<any, any, any>; orderBy: jest.Mock<any, any, any>; skip: jest.Mock<any, any, any>; take: jest.Mock<any, any, any>; getMany: jest.Mock<...>; }' is not assignable to parameter of type 'SelectQueryBuilder<BRD>'.
      Type '{ where: Mock<any, any, any>; andWhere: Mock<any, any, any>; orderBy: Mock<any, any, any>; skip: Mock<any, any, any>; take: Mock<any, any, any>; getMany: Mock<...>; }' is missing the following properties from type 'SelectQueryBuilder<BRD>': "@instanceof", findOptions, selects, joins, and 136 more.

    [7m407[0m       repository.createQueryBuilder.mockReturnValue(mockQueryBuilder);
    [7m   [0m [91m                                                    ~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m414[0m:[93m85[0m - [91merror[0m[90m TS2554: [0mExpected 2-3 arguments, but got 4.

    [7m414[0m       const result = await service.search('organization-id', 'customer portal', 10, 0);
    [7m   [0m [91m                                                                                    ~[0m

FAIL src/ai/__tests__/document-parser.service.spec.ts
  ● Test suite failed to run

    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m35[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m35[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m45[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m45[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m55[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m55[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m66[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m66[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m122[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m122[0m       } as Express.Multer.File;
    [7m   [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m132[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m132[0m       } as Express.Multer.File;
    [7m   [0m [91m                   ~~~~~~[0m

FAIL src/app.module.compile.spec.ts
  ● Test suite failed to run

    [96msrc/app.module.compile.spec.ts[0m:[93m10[0m:[93m28[0m - [91merror[0m[90m TS2307: [0mCannot find module './modules/projects/entities/team-member.entity' or its corresponding type declarations.

    [7m10[0m import { TeamMember } from './modules/projects/entities/team-member.entity';
    [7m  [0m [91m                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/app.module.compile.spec.ts[0m:[93m11[0m:[93m22[0m - [91merror[0m[90m TS2307: [0mCannot find module './modules/projects/entities/role.entity' or its corresponding type declarations.

    [7m11[0m import { Role } from './modules/projects/entities/role.entity';
    [7m  [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/app.module.compile.spec.ts[0m:[93m18[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module './pm/entities/portfolio.entity' or its corresponding type declarations.

    [7m18[0m import { Portfolio } from './pm/entities/portfolio.entity';
    [7m  [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/app.module.compile.spec.ts[0m:[93m19[0m:[93m25[0m - [91merror[0m[90m TS2307: [0mCannot find module './pm/entities/program.entity' or its corresponding type declarations.

    [7m19[0m import { Program } from './pm/entities/program.entity';
    [7m  [0m [91m                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/modules/dashboards/dashboards-mutations.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/dashboards/dashboards-mutations.integration.spec.ts[0m:[93m37[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/dashboard.entity' or its corresponding type declarations.

    [7m37[0m import { Dashboard } from '../entities/dashboard.entity';
    [7m  [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/dashboards/dashboards-mutations.integration.spec.ts[0m:[93m38[0m:[93m33[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/dashboard-widget.entity' or its corresponding type declarations.

    [7m38[0m import { DashboardWidget } from '../entities/dashboard-widget.entity';
    [7m  [0m [91m                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/dashboards/dashboards-mutations.integration.spec.ts[0m:[93m39[0m:[93m37[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/dashboard.entity' or its corresponding type declarations.

    [7m39[0m import { DashboardVisibility } from '../entities/dashboard.entity';
    [7m  [0m [91m                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

[Nest] 55223  - 01/20/2026, 11:03:13 PM   ERROR [TypeOrmModule] Unable to connect to the database. Retrying (1)...
error: database "malikadeel" does not exist
    at Parser.parseErrorMessage (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/pg-protocol/src/parser.ts:369:69)
    at Parser.handlePacket (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/pg-protocol/src/parser.ts:187:21)
    at Parser.parse (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/pg-protocol/src/parser.ts:102:30)
    at Socket.<anonymous> (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/pg-protocol/src/index.ts:7:48)
    at Socket.emit (node:events:507:28)
    at addChunk (node:internal/streams/readable:559:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)
    at Socket.Readable.push (node:internal/streams/readable:390:5)
    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)
FAIL src/modules/rollups/rollups-phase6-closeout.integration.spec.ts (9.69 s)
  ● Console

    console.log
      🔍 Database Config: {
        host: 'yamabiko.proxy.rlwy.net',
        port: '26837',
        database: 'railway',
        username: 'postgres',
        url: 'postgresql://postgres:****@yamabiko.proxy.rlwy.net:26837/railway',
        ssl: false
      }

      at Object.<anonymous> (config/database.config.ts:8:9)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 12)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:57:42)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 10)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 17)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:57:42)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 21)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:57:42)

    console.log
      🚀 ProjectsModule loaded with enterprise-grade assignments!

      at new ProjectsModule (modules/projects/projects.module.ts:105:13)
          at async Promise.all (index 0)
          at async Promise.all (index 35)

    console.log
      DashboardModule loaded

      at new DashboardModule (dashboard/dashboard.module.ts:18:13)
          at async Promise.all (index 0)
          at async Promise.all (index 51)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 58)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:57:42)

    console.log
      [WorkspaceRepo] deleteDateColumn = deletedAt

      at new WorkspacesService (modules/workspaces/workspaces.service.ts:54:13)
          at async Promise.all (index 3)
          at async Promise.all (index 29)

    console.log
      [WorkspaceRepo] columns = [
        { name: 'id', databaseName: 'id' },
        { name: 'organizationId', databaseName: 'organization_id' },
        { name: 'name', databaseName: 'name' },
        { name: 'slug', databaseName: 'slug' },
        { name: 'description', databaseName: 'description' },
        { name: 'isPrivate', databaseName: 'is_private' },
        { name: 'createdBy', databaseName: 'created_by' },
        { name: 'ownerId', databaseName: 'owner_id' },
        { name: 'createdAt', databaseName: 'created_at' },
        { name: 'updatedAt', databaseName: 'updated_at' },
        { name: 'deletedAt', databaseName: 'deleted_at' },
        { name: 'deletedBy', databaseName: 'deleted_by' },
        { name: 'permissionsConfig', databaseName: 'permissions_config' },
        { name: 'defaultMethodology', databaseName: 'default_methodology' },
        { name: 'homeNotes', databaseName: 'home_notes' }
      ]

      at new WorkspacesService (modules/workspaces/workspaces.service.ts:58:13)
          at async Promise.all (index 3)
          at async Promise.all (index 29)

  ● Phase 6 Closeout Integration Tests › Module C.1: Member access boundaries › Member with access to workspace A only cannot read workspace B portfolios, programs, rollups. Expect 404

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.2: Guest read-only access › Guest with access to workspace A can read lists and rollups for A. Cannot write. Expect 403 Forbidden

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.3: Admin-only create › Admin can create portfolio and program in workspace A. Member cannot. Expect 403 Forbidden

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4a. Admin links project to program. portfolioId is auto set from program

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4b. Admin links project to portfolio only. programId stays null

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4c. Admin tries to link project to program from another workspace. Expect 404 or BadRequest, no leak

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4d. Admin provides programId and mismatched portfolioId. Expect 400

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4e. Admin unlinks. programId and portfolioId both null

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.5: Rollup accuracy › 5a. Program rollup totals match seeded data

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.5: Rollup accuracy › 5b. Portfolio rollup totals match seeded data

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

{"level":30,"time":1768971794514,"pid":55232,"hostname":"Adeels-MacBook-Pro.local","req":{"method":"GET","url":"/api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf","query":{"share":"48285796-c2b9-437c-9600-c421094b9ebf"},"params":{"0":"dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0"},"headers":{}},"userId":null,"res":{"statusCode":200,"headers":{}},"responseTime":99,"msg":"GET /api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf completed"}
{"level":40,"time":1768971794652,"pid":55232,"hostname":"Adeels-MacBook-Pro.local","req":{"method":"GET","url":"/api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-C2B9-437C-9600-C421094B9EBF","query":{"share":"48285796-C2B9-437C-9600-C421094B9EBF"},"params":{"0":"dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0"},"headers":{}},"userId":null,"res":{"statusCode":404,"headers":{}},"responseTime":93,"msg":"GET /api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-C2B9-437C-9600-C421094B9EBF completed"}
{"level":40,"time":1768971794783,"pid":55232,"hostname":"Adeels-MacBook-Pro.local","req":{"method":"GET","url":"/api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf%20","query":{"share":"48285796-c2b9-437c-9600-c421094b9ebf "},"params":{"0":"dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0"},"headers":{}},"userId":null,"res":{"statusCode":404,"headers":{}},"responseTime":92,"msg":"GET /api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf%20 completed"}
FAIL src/modules/work-items/work-items-bulk.integration.spec.ts (10.444 s)
  ● Console

    console.log
      🔍 Database Config: {
        host: 'yamabiko.proxy.rlwy.net',
        port: '26837',
        database: 'railway',
        username: 'postgres',
        url: 'postgresql://postgres:****@yamabiko.proxy.rlwy.net:26837/railway',
        ssl: false
      }

      at Object.<anonymous> (config/database.config.ts:8:9)

    console.log
      beforeAll start 2026-01-21T05:03:13.242Z

      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:67:13)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 12)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:68:21)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 10)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 17)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:68:21)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 21)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:68:21)

    console.log
      🚀 ProjectsModule loaded with enterprise-grade assignments!

      at new ProjectsModule (modules/projects/projects.module.ts:105:13)
          at async Promise.all (index 0)
          at async Promise.all (index 35)

    console.log
      DashboardModule loaded

      at new DashboardModule (dashboard/dashboard.module.ts:18:13)
          at async Promise.all (index 0)
          at async Promise.all (index 51)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 58)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:68:21)

    console.log
      [WorkspaceRepo] deleteDateColumn = deletedAt

      at new WorkspacesService (modules/workspaces/workspaces.service.ts:54:13)
          at async Promise.all (index 3)
          at async Promise.all (index 29)

    console.log
      [WorkspaceRepo] columns = [
        { name: 'id', databaseName: 'id' },
        { name: 'organizationId', databaseName: 'organization_id' },
        { name: 'name', databaseName: 'name' },
        { name: 'slug', databaseName: 'slug' },
        { name: 'description', databaseName: 'description' },
        { name: 'isPrivate', databaseName: 'is_private' },
        { name: 'createdBy', databaseName: 'created_by' },
        { name: 'ownerId', databaseName: 'owner_id' },
        { name: 'createdAt', databaseName: 'created_at' },
        { name: 'updatedAt', databaseName: 'updated_at' },
        { name: 'deletedAt', databaseName: 'deleted_at' },
        { name: 'deletedBy', databaseName: 'deleted_by' },
        { name: 'permissionsConfig', databaseName: 'permissions_config' },
        { name: 'defaultMethodology', databaseName: 'default_methodology' },
        { name: 'homeNotes', databaseName: 'home_notes' }
      ]

      at new WorkspacesService (modules/workspaces/workspaces.service.ts:58:13)
          at async Promise.all (index 3)
          at async Promise.all (index 29)

    console.log
      module compiled 2026-01-21T05:03:14.082Z

      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:71:13)

    console.log
      app initialized 2026-01-21T05:03:14.139Z

      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:82:13)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 1. Guest bulk update blocked

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 2. Member bulk update allowed in own workspace

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 3. Member bulk update cannot cross workspace

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 4. Admin bulk update can operate across workspaces when access exists

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 5. Validation: ids max 200 enforced

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 6. Cross project ID mixing blocked

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 7. Status transition validation applies per item

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/delete › 8. Member bulk delete forbidden

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/delete › 9. Admin bulk delete allowed and scoped

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/delete › 10. Non-member gets 404

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

{"level":40,"time":1768971794953,"pid":55232,"hostname":"Adeels-MacBook-Pro.local","req":{"method":"GET","url":"/api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf","query":{"share":"48285796-c2b9-437c-9600-c421094b9ebf"},"params":{"0":"dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0"},"headers":{}},"userId":null,"res":{"statusCode":404,"headers":{}},"responseTime":85,"msg":"GET /api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf completed"}
{"level":40,"time":1768971795137,"pid":55232,"hostname":"Adeels-MacBook-Pro.local","req":{"method":"GET","url":"/api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf","query":{"share":"48285796-c2b9-437c-9600-c421094b9ebf"},"params":{"0":"dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0"},"headers":{}},"userId":null,"res":{"statusCode":404,"headers":{}},"responseTime":87,"msg":"GET /api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf completed"}
PASS src/modules/dashboards/dashboards-share.integration.spec.ts
  ● Console

    console.log
      🔍 Database Config: {
        host: 'yamabiko.proxy.rlwy.net',
        port: '26837',
        database: 'railway',
        username: 'postgres',
        url: 'postgresql://postgres:****@yamabiko.proxy.rlwy.net:26837/railway',
        ssl: false
      }

      at Object.<anonymous> (config/database.config.ts:8:9)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 12)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/dashboards/dashboards-share.integration.spec.ts:40:21)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 10)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 17)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/dashboards/dashboards-share.integration.spec.ts:40:21)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 21)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/dashboards/dashboards-share.integration.spec.ts:40:21)

    console.log
      🚀 ProjectsModule loaded with enterprise-grade assignments!

      at new ProjectsModule (modules/projects/projects.module.ts:105:13)
          at async Promise.all (index 0)
          at async Promise.all (index 35)

    console.log
      DashboardModule loaded

      at new DashboardModule (dashboard/dashboard.module.ts:18:13)
          at async Promise.all (index 0)
          at async Promise.all (index 51)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 58)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/dashboards/dashboards-share.integration.spec.ts:40:21)

    console.log
      [WorkspaceRepo] deleteDateColumn = deletedAt

      at new WorkspacesService (modules/workspaces/workspaces.service.ts:54:13)
          at async Promise.all (index 3)
          at async Promise.all (index 29)

    console.log
      [WorkspaceRepo] columns = [
        { name: 'id', databaseName: 'id' },
        { name: 'organizationId', databaseName: 'organization_id' },
        { name: 'name', databaseName: 'name' },
        { name: 'slug', databaseName: 'slug' },
        { name: 'description', databaseName: 'description' },
        { name: 'isPrivate', databaseName: 'is_private' },
        { name: 'createdBy', databaseName: 'created_by' },
        { name: 'ownerId', databaseName: 'owner_id' },
        { name: 'createdAt', databaseName: 'created_at' },
        { name: 'updatedAt', databaseName: 'updated_at' },
        { name: 'deletedAt', databaseName: 'deleted_at' },
        { name: 'deletedBy', databaseName: 'deleted_by' },
        { name: 'permissionsConfig', databaseName: 'permissions_config' },
        { name: 'defaultMethodology', databaseName: 'default_methodology' },
        { name: 'homeNotes', databaseName: 'home_notes' }
      ]

      at new WorkspacesService (modules/workspaces/workspaces.service.ts:58:13)
          at async Promise.all (index 3)
          at async Promise.all (index 29)

{"level":40,"time":1768971795267,"pid":55232,"hostname":"Adeels-MacBook-Pro.local","req":{"method":"GET","url":"/api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf","query":{"share":"48285796-c2b9-437c-9600-c421094b9ebf"},"params":{"0":"dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0"},"headers":{}},"userId":null,"res":{"statusCode":404,"headers":{}},"responseTime":45,"msg":"GET /api/dashboards/f4b949f1-dd89-45f1-9f33-c9288c4340f0?share=48285796-c2b9-437c-9600-c421094b9ebf completed"}
FAIL src/modules/rollups/rollups.integration.spec.ts (13.701 s)
  ● Console

    console.log
      🔍 Database Config: {
        host: 'N/A',
        port: 'N/A',
        database: 'N/A',
        username: 'N/A',
        url: '',
        ssl: false
      }

      at Object.<anonymous> (config/database.config.ts:8:9)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 12)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:39:42)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 10)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 17)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:39:42)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 5)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 21)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:39:42)

    console.log
      🚀 ProjectsModule loaded with enterprise-grade assignments!

      at new ProjectsModule (modules/projects/projects.module.ts:105:13)
          at async Promise.all (index 0)
          at async Promise.all (index 35)

    console.log
      DashboardModule loaded

      at new DashboardModule (dashboard/dashboard.module.ts:18:13)
          at async Promise.all (index 0)
          at async Promise.all (index 51)

    console.warn
      SendGrid API key not found - emails will not be sent

      24 |       console.log('SendGrid configured successfully');
      25 |     } else {
    > 26 |       console.warn('SendGrid API key not found - emails will not be sent');
         |               ^
      27 |     }
      28 |   }
      29 |

      at new EmailService (shared/services/email.service.ts:26:15)
      at TestingInjector.instantiateClass (../node_modules/@nestjs/core/injector/injector.js:373:19)
      at callback (../node_modules/@nestjs/core/injector/injector.js:65:45)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:145:24)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 58)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:39:42)

  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 1: Member with access to workspace A only - call program rollup in workspace A, gets 200

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 2: Member with access to workspace A only - call program rollup in workspace B, gets 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 3: Program rollup counts are workspace scoped - work items in workspace B do not affect workspace A rollup

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 4: Non existent programId in workspace A returns 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Portfolio Rollup › Test 5: Member with access to workspace A only - portfolio rollup in workspace B, gets 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Portfolio Rollup › Test 6: Admin - portfolio rollup returns totals that match created fixtures

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Portfolio Rollup › Test 7: Non existent portfolioId in workspace A returns 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)


ReferenceError: You are trying to `import` a file after the Jest environment has been torn down. From modules/rollups/rollups.integration.spec.ts.

      at PlatformTools.load (platform/PlatformTools.ts:82:28)
      at PostgresDriver.loadDependencies (driver/postgres/PostgresDriver.ts:1445:67)
      at new PostgresDriver (driver/postgres/PostgresDriver.ts:316:14)
      at DriverFactory.create (driver/DriverFactory.ts:36:24)
      at new DataSource (data-source/DataSource.ts:149:43)
      at ../node_modules/@nestjs/typeorm/dist/typeorm-core.module.js:164:23
      at ../node_modules/@nestjs/typeorm/dist/typeorm-core.module.js:169:36
      at Observable._subscribe (../node_modules/rxjs/src/internal/observable/defer.ts:54:15)
      at Observable.Object.<anonymous>.Observable._trySubscribe (../node_modules/rxjs/src/internal/Observable.ts:235:19)
      at ../node_modules/rxjs/src/internal/Observable.ts:225:18
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.Object.<anonymous>.Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at subscribeForRetryWhen (../node_modules/rxjs/src/internal/operators/retryWhen.ts:74:25)
      at ../node_modules/rxjs/src/internal/operators/retryWhen.ts:85:28
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Object.<anonymous>.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/mergeInternals.ts:85:24
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Object.<anonymous>.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/map.ts:57:20
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Object.<anonymous>.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/take.ts:60:26
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Object.<anonymous>.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at AsyncAction.work (../node_modules/rxjs/src/internal/observable/timer.ts:173:20)
      at AsyncAction.Object.<anonymous>.AsyncAction._execute (../node_modules/rxjs/src/internal/scheduler/AsyncAction.ts:119:12)
      at AsyncAction.Object.<anonymous>.AsyncAction.execute (../node_modules/rxjs/src/internal/scheduler/AsyncAction.ts:94:24)
      at AsyncScheduler.Object.<anonymous>.AsyncScheduler.flush (../node_modules/rxjs/src/internal/scheduler/AsyncScheduler.ts:38:27)
[Nest] 55223  - 01/20/2026, 11:03:18 PM   ERROR [TypeOrmModule] Unable to connect to the database. Retrying (2)...
TypeError: this.postgres.Pool is not a constructor
    at PostgresDriver.createPool (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/src/driver/postgres/PostgresDriver.ts:1507:22)
    at PostgresDriver.connect (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/src/driver/postgres/PostgresDriver.ts:357:38)
    at DataSource.initialize (/Users/malikadeel/Downloads/ZephixApp/zephix-backend/src/data-source/DataSource.ts:253:27)
    at /Users/malikadeel/Downloads/ZephixApp/zephix-backend/node_modules/@nestjs/typeorm/dist/typeorm-core.module.js:187:30
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Summary of all failing tests
FAIL modules/resources/resources.service.spec.ts (5.818 s)
  ● ResourcesService - detectConflicts › detectConflicts - Only HARD allocations › should compute only hardLoad when only HARD allocations exist

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - HARD plus SOFT › should compute both hardLoad and softLoad correctly

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - With thresholds › should classify as WARNING when total exceeds warningThreshold

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - With thresholds › should classify as CRITICAL when hardLoad exceeds criticalThreshold

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - With GHOST present › should exclude GHOST allocations from calculations

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

  ● ResourcesService - detectConflicts › detectConflicts - Without organization settings › should return NONE classification when organizationId not provided

    Nest can't resolve dependencies of the ResourcesService (?, TenantAwareRepository_ResourceAllocation, TaskRepository, TenantAwareRepository_Project, OrganizationRepository, ResourceConflictRepository, DataSource, WorkspaceAccessService, TenantContextService). Please make sure that the argument "TenantAwareRepository_Resource" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_Resource" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_Resource" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_Resource" */ ]
      })

      31 |
      32 |   beforeEach(async () => {
    > 33 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      34 |       providers: [
      35 |         ResourcesService,
      36 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resources.service.spec.ts:33:35)

FAIL modules/notifications/notifications-read-all.spec.ts (5.9 s)
  ● NotificationsService - Read All › Read-all makes unread-count go to 0 › should mark all notifications as read and return 0 unread count

    TypeError: this.notificationRepository.createQueryBuilder(...).where(...).andWhere(...).andWhere(...).getCount is not a function

      148 |         { userId },
      149 |       )
    > 150 |       .getCount();
          |        ^
      151 |
      152 |     return count;
      153 |   }

      at NotificationsService.getUnreadCount (modules/notifications/notifications.service.ts:150:8)
      at Object.<anonymous> (modules/notifications/notifications-read-all.spec.ts:77:47)

FAIL modules/workspaces/services/workspace-access.service.spec.ts (5.954 s)
  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_owner for platform ADMIN even without WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_owner for platform ADMIN with legacy role string

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_member for MEMBER with WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return workspace_viewer for VIEWER with WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return null for MEMBER with no WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return null for VIEWER with no WorkspaceMember row

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › getEffectiveWorkspaceRole › should return null if workspace belongs to different organization

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › hasWorkspaceRoleAtLeast › should return true when actual role satisfies required role

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › hasWorkspaceRoleAtLeast › should return false when actual role does not satisfy required role

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

  ● WorkspaceAccessService › hasWorkspaceRoleAtLeast › should return false for null actual role

    Nest can't resolve dependencies of the WorkspaceAccessService (?, ConfigService, TenantContextService). Please make sure that the argument "TenantAwareRepository_WorkspaceMember" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_WorkspaceMember" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_WorkspaceMember" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_WorkspaceMember" */ ]
      })

      22 |
      23 |   beforeEach(async () => {
    > 24 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      25 |       providers: [
      26 |         WorkspaceAccessService,
      27 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/workspaces/services/workspace-access.service.spec.ts:24:35)

FAIL modules/auth/auth-session-refresh.spec.ts (6.099 s)
  ● AuthService - Refresh Token Security › Refresh rotates token and old token fails › should rotate refresh token and reject old token

    REFRESH_TOKEN_PEPPER environment variable is required for refresh token hashing

      57 |   static hashRefreshToken(rawRefreshToken: string): string {
      58 |     if (!this.REFRESH_TOKEN_PEPPER) {
    > 59 |       throw new Error(
         |             ^
      60 |         'REFRESH_TOKEN_PEPPER environment variable is required for refresh token hashing',
      61 |       );
      62 |     }

      at TokenHashUtil.hashRefreshToken (common/security/token-hash.util.ts:59:13)
      at Object.<anonymous> (modules/auth/auth-session-refresh.spec.ts:118:37)

FAIL modules/workspaces/guards/require-org-role.guard.spec.ts
  ● RequireOrgRoleGuard › when no role requirement › should allow access

    ForbiddenException: Authentication required

      26 |
      27 |     if (!user) {
    > 28 |       throw new ForbiddenException('Authentication required');
         |             ^
      29 |     }
      30 |
      31 |     const requiredRole = this.reflector.get<string | PlatformRole>(

      at RequireOrgRoleGuard.canActivate (modules/workspaces/guards/require-org-role.guard.ts:28:13)
      at Object.<anonymous> (modules/workspaces/guards/require-org-role.guard.spec.ts:29:28)

FAIL modules/work-management/services/task-dependencies.service.spec.ts (6.183 s)
  ● TaskDependenciesService › addDependency - cycle detection › should reject self-dependency

    Nest can't resolve dependencies of the TaskDependenciesService (TenantAwareRepository_WorkTaskDependency, TenantAwareRepository_WorkTask, TaskActivityService, TenantContextService, ?). Please make sure that the argument ProjectHealthService at index [4] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If ProjectHealthService is a provider, is it part of the current RootTestModule?
    - If ProjectHealthService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing ProjectHealthService */ ]
      })

      45 |     };
      46 |
    > 47 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      48 |       providers: [
      49 |         TaskDependenciesService,
      50 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 4)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-management/services/task-dependencies.service.spec.ts:47:35)

  ● TaskDependenciesService › addDependency - cycle detection › should detect cycle: A->B, B->C, then reject C->A

    Nest can't resolve dependencies of the TaskDependenciesService (TenantAwareRepository_WorkTaskDependency, TenantAwareRepository_WorkTask, TaskActivityService, TenantContextService, ?). Please make sure that the argument ProjectHealthService at index [4] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If ProjectHealthService is a provider, is it part of the current RootTestModule?
    - If ProjectHealthService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing ProjectHealthService */ ]
      })

      45 |     };
      46 |
    > 47 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      48 |       providers: [
      49 |         TaskDependenciesService,
      50 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 4)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-management/services/task-dependencies.service.spec.ts:47:35)

  ● TaskDependenciesService › addDependency - cycle detection › should return 409 CONFLICT for duplicate dependency

    Nest can't resolve dependencies of the TaskDependenciesService (TenantAwareRepository_WorkTaskDependency, TenantAwareRepository_WorkTask, TaskActivityService, TenantContextService, ?). Please make sure that the argument ProjectHealthService at index [4] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If ProjectHealthService is a provider, is it part of the current RootTestModule?
    - If ProjectHealthService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing ProjectHealthService */ ]
      })

      45 |     };
      46 |
    > 47 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      48 |       providers: [
      49 |         TaskDependenciesService,
      50 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 4)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/work-management/services/task-dependencies.service.spec.ts:47:35)

FAIL modules/resources/resource-allocation.service.spec.ts (6.146 s)
  ● ResourceAllocationService - validateGovernance › validateGovernance - No overlap dates › should not throw error when dates do not overlap

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Overlap below thresholds › should not throw error when projectedTotal is below hardCap and requireJustificationAbove

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Hard cap rule › should throw error when projectedTotal exceeds hardCap

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Justification rule › should throw error when projectedTotal exceeds requireJustificationAbove without justification

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Justification rule › should not throw error when projectedTotal exceeds requireJustificationAbove with justification

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - Justification rule › should throw error when justification is empty string

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

  ● ResourceAllocationService - validateGovernance › validateGovernance - GHOST exclusion › should exclude GHOST allocations from calculations

    Nest can't resolve dependencies of the ResourceAllocationService (?, TenantAwareRepository_UserDailyCapacity, TenantAwareRepository_Resource, TaskRepository, OrganizationRepository, ResourceConflictRepository, DataSource, ResourceTimelineService, TenantContextService). Please make sure that the argument "TenantAwareRepository_ResourceAllocation" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_ResourceAllocation" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_ResourceAllocation" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_ResourceAllocation" */ ]
      })

      41 |
      42 |   beforeEach(async () => {
    > 43 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      44 |       providers: [
      45 |         ResourceAllocationService,
      46 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadProvider (../node_modules/@nestjs/core/injector/injector.js:98:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:56:13
          at async Promise.all (index 3)
      at TestingInstanceLoader.createInstancesOfProviders (../node_modules/@nestjs/core/injector/instance-loader.js:55:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:40:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/resources/resource-allocation.service.spec.ts:43:35)

FAIL modules/integrations/integrations-webhook.controller.spec.ts
  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should return 202 with status "ignored" when webhookEnabled is false

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should return 202 with status "accepted" when webhookEnabled is true

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should throw BadRequestException if connection not found

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

  ● IntegrationsWebhookController - Contract Tests › POST /api/integrations/jira/webhook/:connectionId › should return { data } format (no secrets)

    Nest can't resolve dependencies of the IntegrationsWebhookController (?, IntegrationEncryptionService). Please make sure that the argument "TenantAwareRepository_IntegrationConnection" at index [0] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If "TenantAwareRepository_IntegrationConnection" is a provider, is it part of the current RootTestModule?
    - If "TenantAwareRepository_IntegrationConnection" is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing "TenantAwareRepository_IntegrationConnection" */ ]
      })

      36 |
      37 |   beforeEach(async () => {
    > 38 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      39 |       controllers: [IntegrationsWebhookController],
      40 |       providers: [
      41 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 0)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (modules/integrations/integrations-webhook.controller.spec.ts:38:35)

FAIL admin/admin.controller.spec.ts
  ● AdminController - Contract Tests › GET /admin/stats › should return { data: Stats } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/stats › should return { data: Stats } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/health › should return { data: SystemHealth } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/health › should return { data: SystemHealth } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/org/summary › should return { data: OrgSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/org/summary › should return { data: OrgSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/users/summary › should return { data: UserSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/users/summary › should return { data: UserSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/workspaces/summary › should return { data: WorkspaceSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/workspaces/summary › should return { data: WorkspaceSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/risk/summary › should return { data: RiskSummary } format

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

  ● AdminController - Contract Tests › GET /admin/risk/summary › should return { data: RiskSummary } on error (never throw 500)

    Nest can't resolve dependencies of the AdminController (AdminService, OrganizationsService, WorkspacesService, ?). Please make sure that the argument TemplatesSeedService at index [3] is available in the RootTestModule context.

    Potential solutions:
    - Is RootTestModule a valid NestJS module?
    - If TemplatesSeedService is a provider, is it part of the current RootTestModule?
    - If TemplatesSeedService is exported from a separate @Module, is that module imported within RootTestModule?
      @Module({
        imports: [ /* the Module containing TemplatesSeedService */ ]
      })

      19 |
      20 |   beforeEach(async () => {
    > 21 |     const module: TestingModule = await Test.createTestingModule({
         |                                   ^
      22 |       controllers: [AdminController],
      23 |       providers: [
      24 |         {

      at TestingInjector.lookupComponentInParentModules (../node_modules/@nestjs/core/injector/injector.js:262:19)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/core/injector/injector.js:215:33)
      at TestingInjector.resolveComponentInstance (../node_modules/@nestjs/testing/testing-injector.js:19:45)
      at resolveParam (../node_modules/@nestjs/core/injector/injector.js:129:38)
          at async Promise.all (index 3)
      at TestingInjector.resolveConstructorParams (../node_modules/@nestjs/core/injector/injector.js:144:27)
      at TestingInjector.loadInstance (../node_modules/@nestjs/core/injector/injector.js:70:13)
      at TestingInjector.loadController (../node_modules/@nestjs/core/injector/injector.js:89:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:68:13
          at async Promise.all (index 0)
      at TestingInstanceLoader.createInstancesOfControllers (../node_modules/@nestjs/core/injector/instance-loader.js:67:9)
      at ../node_modules/@nestjs/core/injector/instance-loader.js:42:13
          at async Promise.all (index 1)
      at TestingInstanceLoader.createInstances (../node_modules/@nestjs/core/injector/instance-loader.js:39:9)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/core/injector/instance-loader.js:22:13)
      at TestingInstanceLoader.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-instance-loader.js:9:9)
      at TestingModuleBuilder.createInstancesOfDependencies (../node_modules/@nestjs/testing/testing-module.builder.js:118:9)
      at TestingModuleBuilder.compile (../node_modules/@nestjs/testing/testing-module.builder.js:74:9)
      at Object.<anonymous> (admin/admin.controller.spec.ts:21:35)

FAIL billing/billing.controller.spec.ts (6.732 s)
  ● BillingController - Contract Tests › GET /billing/plans › should return { data: [] } on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getPlans (billing/controllers/billing.controller.ts:50:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:101:22)

  ● BillingController - Contract Tests › GET /billing/subscription › should return { data: Subscription | null } format

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getSubscription (billing/controllers/billing.controller.ts:79:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:114:39)

  ● BillingController - Contract Tests › GET /billing/subscription › should return { data: null } when no subscription exists

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getSubscription (billing/controllers/billing.controller.ts:79:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:127:39)

  ● BillingController - Contract Tests › GET /billing/subscription › should return { data: null } on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getSubscription (billing/controllers/billing.controller.ts:79:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:137:39)

  ● BillingController - Contract Tests › GET /billing/current-plan › should return { data: CurrentPlan } format

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getCurrentPlan (billing/controllers/billing.controller.ts:109:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:149:39)

  ● BillingController - Contract Tests › GET /billing/current-plan › should return { data: Plan } on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getCurrentPlan (billing/controllers/billing.controller.ts:109:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:165:39)

  ● BillingController - Contract Tests › GET /billing/usage › should return { data: Usage } format

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getUsage (billing/controllers/billing.controller.ts:247:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:177:39)

  ● BillingController - Contract Tests › GET /billing/usage › should return safe defaults on error (never throw 500)

    UnauthorizedException: Missing user

       5 |   const user = req.user;
       6 |   if (!user?.id) {
    >  7 |     throw new UnauthorizedException('Missing user');
         |           ^
       8 |   }
       9 |   return {
      10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.getUsage (billing/controllers/billing.controller.ts:247:48)
      at Object.<anonymous> (billing/billing.controller.spec.ts:192:39)

  ● BillingController - Contract Tests › POST /billing/subscribe › should return 403 for internalManaged organizations

    expect(received).rejects.toThrow(expected)

    Expected constructor: ForbiddenException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.subscribe (billing/controllers/billing.controller.ts:142:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:207:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:207:67)

  ● BillingController - Contract Tests › POST /billing/subscribe › should return 501 if not implemented

    expect(received).rejects.toThrow(expected)

    Expected constructor: NotImplementedException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.subscribe (billing/controllers/billing.controller.ts:142:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:216:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:216:67)

  ● BillingController - Contract Tests › PATCH /billing/subscription › should return 403 for internalManaged organizations when changing plan

    expect(received).rejects.toThrow(expected)

    Expected constructor: ForbiddenException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.updateSubscription (billing/controllers/billing.controller.ts:175:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:227:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:227:76)

  ● BillingController - Contract Tests › PATCH /billing/subscription › should return 501 if not implemented

    expect(received).rejects.toThrow(expected)

    Expected constructor: NotImplementedException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.updateSubscription (billing/controllers/billing.controller.ts:175:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:236:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:236:76)

  ● BillingController - Contract Tests › POST /billing/cancel › should return 403 for internalManaged organizations

    expect(received).rejects.toThrow(expected)

    Expected constructor: ForbiddenException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.cancelSubscription (billing/controllers/billing.controller.ts:205:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:246:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:246:71)

  ● BillingController - Contract Tests › POST /billing/cancel › should return 501 if not implemented

    expect(received).rejects.toThrow(expected)

    Expected constructor: NotImplementedException
    Received constructor: UnauthorizedException

    Received message: "Missing user"

           5 |   const user = req.user;
           6 |   if (!user?.id) {
        >  7 |     throw new UnauthorizedException('Missing user');
             |           ^
           8 |   }
           9 |   return {
          10 |     userId: user.id,

      at getAuthContext (common/http/get-auth-context.ts:7:11)
      at BillingController.cancelSubscription (billing/controllers/billing.controller.ts:205:46)
      at Object.<anonymous> (billing/billing.controller.spec.ts:254:31)
      at Object.toThrow (../node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (billing/billing.controller.spec.ts:254:71)

FAIL brd/validation/__tests__/brd-validation.service.spec.ts
  ● Test suite failed to run

    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m16[0m:[93m13[0m - [91merror[0m[90m TS2339: [0mProperty 'onModuleInit' does not exist on type 'BRDValidationService'.

    [7m16[0m     service.onModuleInit();
    [7m  [0m [91m            ~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m52[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m52[0m       expect(result.errors.some(e => e.path.includes('metadata'))).toBe(true);
    [7m  [0m [91m                                       ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m71[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m71[0m       expect(result.errors.some(e => e.message.includes('email'))).toBe(true);
    [7m  [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m86[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m86[0m       expect(result.errors.some(e => e.message.includes('Must be one of'))).toBe(true);
    [7m  [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m101[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m101[0m       expect(result.errors.some(e => e.message.includes('at least'))).toBe(true);
    [7m   [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m121[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m121[0m       expect(result.errors.some(e => e.message.includes('pattern'))).toBe(true);
    [7m   [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m136[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m136[0m       expect(result.errors.some(e => e.message.includes('no more than'))).toBe(true);
    [7m   [0m [91m                                       ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m143[0m:[93m17[0m - [91merror[0m[90m TS2339: [0mProperty 'validateOrThrow' does not exist on type 'BRDValidationService'.

    [7m143[0m         service.validateOrThrow(seedData);
    [7m   [0m [91m                ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m155[0m:[93m17[0m - [91merror[0m[90m TS2339: [0mProperty 'validateOrThrow' does not exist on type 'BRDValidationService'.

    [7m155[0m         service.validateOrThrow(invalidPayload);
    [7m   [0m [91m                ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m174[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'isValid' does not exist on type 'ValidationSummary'.

    [7m174[0m       expect(summary.isValid).toBe(true);
    [7m   [0m [91m                     ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m175[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'errorCount' does not exist on type 'ValidationSummary'.

    [7m175[0m       expect(summary.errorCount).toBe(0);
    [7m   [0m [91m                     ~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m176[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'errorsBySection' does not exist on type 'ValidationSummary'.

    [7m176[0m       expect(summary.errorsBySection).toEqual({});
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m177[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'missingRequiredFields' does not exist on type 'ValidationSummary'. Did you mean 'missingRequired'?

    [7m177[0m       expect(summary.missingRequiredFields).toHaveLength(0);
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/brd/validation/brd-validation.service.ts[0m:[93m14[0m:[93m3[0m
        [7m14[0m   missingRequired: string[];
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'missingRequired' is declared here.
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m199[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'isValid' does not exist on type 'ValidationSummary'.

    [7m199[0m       expect(summary.isValid).toBe(false);
    [7m   [0m [91m                     ~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m200[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'errorCount' does not exist on type 'ValidationSummary'.

    [7m200[0m       expect(summary.errorCount).toBeGreaterThan(0);
    [7m   [0m [91m                     ~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m201[0m:[93m34[0m - [91merror[0m[90m TS2339: [0mProperty 'errorsBySection' does not exist on type 'ValidationSummary'.

    [7m201[0m       expect(Object.keys(summary.errorsBySection).length).toBeGreaterThan(0);
    [7m   [0m [91m                                 ~~~~~~~~~~~~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m202[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'missingRequiredFields' does not exist on type 'ValidationSummary'. Did you mean 'missingRequired'?

    [7m202[0m       expect(summary.missingRequiredFields.length).toBeGreaterThan(0);
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/brd/validation/brd-validation.service.ts[0m:[93m14[0m:[93m3[0m
        [7m14[0m   missingRequired: string[];
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'missingRequired' is declared here.
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m219[0m:[93m31[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m219[0m       expect(result.errors[0].path).toBe('metadata.title');
    [7m   [0m [91m                              ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m237[0m:[93m52[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m237[0m       const titleError = result.errors.find(e => e.path.includes('functionalRequirements') && e.path.includes('title'));
    [7m   [0m [91m                                                   ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m237[0m:[93m97[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m237[0m       const titleError = result.errors.find(e => e.path.includes('functionalRequirements') && e.path.includes('title'));
    [7m   [0m [91m                                                                                                ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m239[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'path' does not exist on type 'string'.

    [7m239[0m       expect(titleError?.path).toMatch(/functionalRequirements\.\d+\.title/);
    [7m   [0m [91m                         ~~~~[0m
    [96msrc/brd/validation/__tests__/brd-validation.service.spec.ts[0m:[93m272[0m:[93m63[0m - [91merror[0m[90m TS2339: [0mProperty 'message' does not exist on type 'string'.

    [7m272[0m         expect(result.errors.some(e => expectedMessage.test(e.message))).toBe(true);
    [7m   [0m [91m                                                              ~~~~~~~[0m

FAIL modules/templates/controllers/templates.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m66[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m66[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, mockUser, req);
    [7m  [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m80[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m80[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, mockUser, req);
    [7m  [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m91[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m91[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, mockUser, req);
    [7m  [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m100[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findAll' does not exist on type 'TemplatesController'.

    [7m100[0m       const result = await controller.findAll(undefined, undefined, undefined, undefined, undefined, undefined, undefined, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m113[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findOne' does not exist on type 'TemplatesController'.

    [7m113[0m       const result = await controller.findOne('test-template-id', mockUser, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m126[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findOne' does not exist on type 'TemplatesController'.

    [7m126[0m       const result = await controller.findOne('non-existent-id', mockUser, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m136[0m:[93m39[0m - [91merror[0m[90m TS2339: [0mProperty 'findOne' does not exist on type 'TemplatesController'.

    [7m136[0m       const result = await controller.findOne('test-template-id', mockUser, req);
    [7m   [0m [91m                                      ~~~~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m159[0m:[93m91[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m159[0m       const result = await controller.instantiate('test-template-id', validDto, mockUser, req);
    [7m   [0m [91m                                                                                          ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m162[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m162[0m       expect(result.data).toHaveProperty('projectId');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m163[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m163[0m       expect(result.data).toHaveProperty('name');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m164[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m164[0m       expect(result.data).toHaveProperty('workspaceId');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m165[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'data' does not exist on type 'void'.

    [7m165[0m       expect(result.data.projectId).toBe('test-project-id');
    [7m   [0m [91m                    ~~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m172[0m:[93m85[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m172[0m       await expect(controller.instantiate('test-template-id', invalidDto, mockUser, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                    ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m175[0m:[93m80[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m175[0m         await controller.instantiate('test-template-id', invalidDto, mockUser, req);
    [7m   [0m [91m                                                                               ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m186[0m:[93m85[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m186[0m       await expect(controller.instantiate('test-template-id', invalidDto, mockUser, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                    ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m189[0m:[93m80[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m189[0m         await controller.instantiate('test-template-id', invalidDto, mockUser, req);
    [7m   [0m [91m                                                                               ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m200[0m:[93m89[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m200[0m       await expect(controller.instantiate('test-template-id', validDto, userWithoutOrg, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                        ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m203[0m:[93m84[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m203[0m         await controller.instantiate('test-template-id', validDto, userWithoutOrg, req);
    [7m   [0m [91m                                                                                   ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m214[0m:[93m82[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m214[0m       await expect(controller.instantiate('non-existent-id', validDto, mockUser, req)).rejects.toThrow(NotFoundException);
    [7m   [0m [91m                                                                                 ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m221[0m:[93m83[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m221[0m       await expect(controller.instantiate('test-template-id', validDto, mockUser, req)).rejects.toThrow(ForbiddenException);
    [7m   [0m [91m                                                                                  ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m228[0m:[93m83[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m228[0m       await expect(controller.instantiate('test-template-id', validDto, mockUser, req)).rejects.toThrow(BadRequestException);
    [7m   [0m [91m                                                                                  ~~~[0m
    [96msrc/modules/templates/controllers/templates.controller.spec.ts[0m:[93m231[0m:[93m78[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ headers: {}; }' is not assignable to parameter of type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>'.
      Type '{ headers: {}; }' is missing the following properties from type 'Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>': get, header, accepts, acceptsCharsets, and 90 more.

    [7m231[0m         await controller.instantiate('test-template-id', validDto, mockUser, req);
    [7m   [0m [91m                                                                             ~~~[0m

FAIL workflows/__tests__/workflow-templates.service.spec.ts
  ● Test suite failed to run

    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m136[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'approvals' does not exist in type 'CreateWorkflowStageDto'.

    [7m136[0m           approvals: [
    [7m   [0m [91m          ~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m268[0m:[93m36[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m268[0m       const result = await service.getWorkflowTemplates(organizationId);
    [7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m287[0m:[93m21[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m287[0m       await service.getWorkflowTemplates(
    [7m   [0m [91m                    ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m317[0m:[93m36[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplateById' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m317[0m       const result = await service.getWorkflowTemplateById(templateId, organizationId);
    [7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m327[0m:[93m17[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplateById' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m327[0m         service.getWorkflowTemplateById(templateId, organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m397[0m:[93m21[0m - [91merror[0m[90m TS2554: [0mExpected 3 arguments, but got 2.

    [7m397[0m       await service.deleteWorkflowTemplate(templateId, organizationId);
    [7m   [0m [91m                    ~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m268[0m:[93m5[0m
        [7m268[0m     userId: string,
        [7m   [0m [96m    ~~~~~~~~~~~~~~[0m
        An argument for 'userId' was not provided.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m415[0m:[93m17[0m - [91merror[0m[90m TS2554: [0mExpected 3 arguments, but got 2.

    [7m415[0m         service.deleteWorkflowTemplate(templateId, organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m268[0m:[93m5[0m
        [7m268[0m     userId: string,
        [7m   [0m [96m    ~~~~~~~~~~~~~~[0m
        An argument for 'userId' was not provided.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m429[0m:[93m17[0m - [91merror[0m[90m TS2554: [0mExpected 3 arguments, but got 2.

    [7m429[0m         service.deleteWorkflowTemplate(templateId, organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m268[0m:[93m5[0m
        [7m268[0m     userId: string,
        [7m   [0m [96m    ~~~~~~~~~~~~~~[0m
        An argument for 'userId' was not provided.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m475[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m475[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockOriginalTemplate as any);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m475[0m:[93m54[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m475[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockOriginalTemplate as any);
    [7m   [0m [91m                                                     ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m480[0m:[93m36[0m - [91merror[0m[90m TS2551: [0mProperty 'cloneWorkflowTemplate' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m480[0m       const result = await service.cloneWorkflowTemplate(
    [7m   [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m561[0m:[93m17[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m561[0m         service.getWorkflowTemplates(organizationId)
    [7m   [0m [91m                ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.service.spec.ts[0m:[93m572[0m:[93m23[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m572[0m         await service.getWorkflowTemplates(organizationId);
    [7m   [0m [91m                      ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.

FAIL modules/projects/controllers/projects.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m8[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../app.module' or its corresponding type declarations.

    [7m8[0m import { AppModule } from '../../app.module';
    [7m [0m [91m                          ~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m10[0m:[93m22[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/team.entity' or its corresponding type declarations.

    [7m10[0m import { Team } from '../entities/team.entity';
    [7m  [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m11[0m:[93m28[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/team-member.entity' or its corresponding type declarations.

    [7m11[0m import { TeamMember } from '../entities/team-member.entity';
    [7m  [0m [91m                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m12[0m:[93m32[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/role.entity' or its corresponding type declarations.

    [7m12[0m import { Role, RoleType } from '../entities/role.entity';
    [7m  [0m [91m                               ~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m13[0m:[93m22[0m - [91merror[0m[90m TS2307: [0mCannot find module '../../modules/users/entities/user.entity' or its corresponding type declarations.

    [7m13[0m import { User } from "../../modules/users/entities/user.entity"
    [7m  [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m107[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'workspaceId' is missing in type '{ name: string; description: string; status: any; priority: any; }' but required in type 'CreateProjectDto'.

    [7m107[0m     const createProjectDto: CreateProjectDto = {
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m

      [96msrc/modules/projects/dto/create-project.dto.ts[0m:[93m48[0m:[93m3[0m
        [7m48[0m   workspaceId: string;
        [7m  [0m [96m  ~~~~~~~~~~~[0m
        'workspaceId' is declared here.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m115[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m115[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m145[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m145[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m157[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m157[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m170[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m170[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m181[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m181[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m212[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m212[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m229[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m229[0m       await request(app.getHttpServer()).get('/api/projects').expect(401);
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m247[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m247[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m260[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m260[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m291[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m291[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m307[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m307[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m328[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m328[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m335[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m335[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m344[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m344[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m381[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m381[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m411[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m411[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m423[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m423[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m433[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m433[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m464[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m464[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m473[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m473[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m480[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m480[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m489[0m:[93m39[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<Project>[]): Project[]', gave the following error.
        Object literal may only specify known properties, and 'name' does not exist in type 'DeepPartial<Project>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<Project>): Project', gave the following error.
        Object literal may only specify known properties, but 'createdBy' does not exist in type 'DeepPartial<Project>'. Did you mean to write 'createdById'?

    [7m489[0m       testProject = projectRepository.create({
    [7m   [0m [91m                                      ~~~~~~[0m

    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m534[0m:[93m32[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m534[0m         const response = await request(app.getHttpServer())
    [7m   [0m [91m                               ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m553[0m:[93m15[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m553[0m         await request(app.getHttpServer())
    [7m   [0m [91m              ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m567[0m:[93m32[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m567[0m         const response = await request(app.getHttpServer())
    [7m   [0m [91m                               ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m584[0m:[93m15[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m584[0m         await request(app.getHttpServer())
    [7m   [0m [91m              ~~~~~~~[0m

      [96msrc/modules/projects/controllers/projects.controller.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL modules/templates/services/templates.service.spec.ts
  ● Test suite failed to run

    [96msrc/modules/templates/services/templates.service.spec.ts[0m:[93m113[0m:[93m9[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' to type 'TemplateBlock' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'TemplateBlock': template, block

    [7m113[0m         {
    [7m   [0m [91m        ~[0m
    [7m114[0m           id: 'tb-1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m123[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m124[0m         } as TemplateBlock,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/templates/services/templates.service.spec.ts[0m:[93m125[0m:[93m9[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' to type 'TemplateBlock' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; organizationId: string; templateId: string; blockId: string; enabled: true; displayOrder: number; config: { threshold: number; }; locked: false; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'TemplateBlock': template, block

    [7m125[0m         {
    [7m   [0m [91m        ~[0m
    [7m126[0m           id: 'tb-2',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m135[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m136[0m         } as TemplateBlock,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/templates/services/templates.service.spec.ts[0m:[93m160[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'id' does not exist on type 'Template[]'.

    [7m160[0m       expect(result.id).toBe('cloned-template-123');
    [7m   [0m [91m                    ~~[0m

FAIL workflows/__tests__/workflow-templates.controller.spec.ts
  ● Test suite failed to run

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m155[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'approvals' does not exist in type 'CreateWorkflowStageDto'.

    [7m155[0m           approvals: [
    [7m   [0m [91m          ~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m192[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: WorkflowStatus; version: number; isDefault: boolean; isPublic: boolean; usageCount: number; tags: any[]; metadata: {}; organizationId: string; createdBy: string; createdAt: Date; ... 6 more ...; id: string; }' is not assignable to parameter of type 'WorkflowTemplate | Promise<WorkflowTemplate>'.
      Type '{ status: WorkflowStatus; version: number; isDefault: boolean; isPublic: boolean; usageCount: number; tags: any[]; metadata: {}; organizationId: string; createdBy: string; createdAt: Date; ... 6 more ...; id: string; }' is missing the following properties from type 'WorkflowTemplate': lastUsedAt, deletedAt, organization, creator, and 5 more.

    [7m192[0m       jest.spyOn(service, 'createWorkflowTemplate').mockResolvedValue(mockCreatedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m246[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m246[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m246[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m246[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m255[0m:[93m9[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m255[0m         1, // page
    [7m   [0m [91m        ~~~~~~~~~~[0m
    [7m256[0m         20 // limit
    [7m   [0m [91m~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m262[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m262[0m       expect(service.getWorkflowTemplates).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m283[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m283[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m283[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m283[0m       jest.spyOn(service, 'getWorkflowTemplates').mockResolvedValue(mockResponse);
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m292[0m:[93m9[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m292[0m         1,
    [7m   [0m [91m        ~~[0m
    [7m293[0m         10
    [7m   [0m [91m~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m296[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplates' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m296[0m       expect(service.getWorkflowTemplates).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m318[0m:[93m11[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m318[0m           0, // Invalid page
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~~~[0m
    [7m319[0m           20
    [7m   [0m [91m~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m332[0m:[93m11[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m332[0m           1,
    [7m   [0m [91m          ~~[0m
    [7m333[0m           0 // Invalid limit
    [7m   [0m [91m~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m345[0m:[93m11[0m - [91merror[0m[90m TS2554: [0mExpected 1-6 arguments, but got 8.

    [7m345[0m           1,
    [7m   [0m [91m          ~~[0m
    [7m346[0m           101 // Invalid limit
    [7m   [0m [91m~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m367[0m:[93m67[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; isDefault: boolean; status: WorkflowStatus; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; name: string; isDefault: boolean; status: WorkflowStatus; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': description, type, version, usageCount, and 2 more.

    [7m367[0m       jest.spyOn(service, 'getDefaultTemplate').mockResolvedValue(mockDefaultTemplate);
    [7m   [0m [91m                                                                  ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m399[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m399[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockTemplate);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m399[0m:[93m54[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m399[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockResolvedValue(mockTemplate);
    [7m   [0m [91m                                                     ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m405[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'getWorkflowTemplateById' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m405[0m       expect(service.getWorkflowTemplateById).toHaveBeenCalledWith(templateId, 'org-123');
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m409[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplateById"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m409[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockRejectedValue(
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m409[0m:[93m54[0m - [91merror[0m[90m TS2339: [0mProperty 'mockRejectedValue' does not exist on type 'never'.

    [7m409[0m       jest.spyOn(service, 'getWorkflowTemplateById').mockRejectedValue(
    [7m   [0m [91m                                                     ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m438[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; description: string; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; name: string; description: string; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': type, status, isDefault, version, and 3 more.

    [7m438[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockUpdatedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m508[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m508[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m508[0m:[93m52[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m508[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                                                   ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m512[0m:[93m9[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ newName: string; }' is not assignable to parameter of type 'CloneTemplateDto'.
      Property 'name' is missing in type '{ newName: string; }' but required in type 'CloneTemplateDto'.

    [7m512[0m         cloneBody,
    [7m   [0m [91m        ~~~~~~~~~[0m

      [96msrc/workflows/dto/workflow.dto.ts[0m:[93m467[0m:[93m3[0m
        [7m467[0m   name: string;
        [7m   [0m [96m  ~~~~[0m
        'name' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m518[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'cloneWorkflowTemplate' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m518[0m       expect(service.cloneWorkflowTemplate).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m533[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"cloneWorkflowTemplate"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m533[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m533[0m:[93m52[0m - [91merror[0m[90m TS2339: [0mProperty 'mockResolvedValue' does not exist on type 'never'.

    [7m533[0m       jest.spyOn(service, 'cloneWorkflowTemplate').mockResolvedValue(mockClonedTemplate);
    [7m   [0m [91m                                                   ~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m537[0m:[93m9[0m - [91merror[0m[90m TS2345: [0mArgument of type '{}' is not assignable to parameter of type 'CloneTemplateDto'.
      Property 'name' is missing in type '{}' but required in type 'CloneTemplateDto'.

    [7m537[0m         {},
    [7m   [0m [91m        ~~[0m

      [96msrc/workflows/dto/workflow.dto.ts[0m:[93m467[0m:[93m3[0m
        [7m467[0m   name: string;
        [7m   [0m [96m  ~~~~[0m
        'name' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m542[0m:[93m22[0m - [91merror[0m[90m TS2551: [0mProperty 'cloneWorkflowTemplate' does not exist on type 'WorkflowTemplatesService'. Did you mean 'createWorkflowTemplate'?

    [7m542[0m       expect(service.cloneWorkflowTemplate).toHaveBeenCalledWith(
    [7m   [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/services/workflow-templates.service.ts[0m:[93m56[0m:[93m9[0m
        [7m56[0m   async createWorkflowTemplate(
        [7m  [0m [96m        ~~~~~~~~~~~~~~~~~~~~~~[0m
        'createWorkflowTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m565[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; status: WorkflowStatus; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; status: WorkflowStatus; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': name, description, type, isDefault, and 4 more.

    [7m565[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockActivatedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m594[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; status: WorkflowStatus; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; status: WorkflowStatus; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': name, description, type, isDefault, and 4 more.

    [7m594[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockArchivedTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m623[0m:[93m71[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; isDefault: boolean; stages: any[]; }' is not assignable to parameter of type 'WorkflowTemplateDto | Promise<WorkflowTemplateDto>'.
      Type '{ id: string; isDefault: boolean; stages: any[]; }' is missing the following properties from type 'WorkflowTemplateDto': name, description, type, status, and 4 more.

    [7m623[0m       jest.spyOn(service, 'updateWorkflowTemplate').mockResolvedValue(mockDefaultTemplate);
    [7m   [0m [91m                                                                      ~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m625[0m:[93m39[0m - [91merror[0m[90m TS2551: [0mProperty 'setAsDefaultTemplate' does not exist on type 'WorkflowTemplatesController'. Did you mean 'getDefaultTemplate'?

    [7m625[0m       const result = await controller.setAsDefaultTemplate(templateId, mockRequest as any);
    [7m   [0m [91m                                      ~~~~~~~~~~~~~~~~~~~~[0m

      [96msrc/workflows/controllers/workflow-templates.controller.ts[0m:[93m155[0m:[93m9[0m
        [7m155[0m   async getDefaultTemplate(
        [7m   [0m [96m        ~~~~~~~~~~~~~~~~~~[0m
        'getDefaultTemplate' is declared here.
    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m655[0m:[93m27[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(object: WorkflowTemplatesService, method: never): SpyInstance<never, never, any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'never'.
      Overload 2 of 3, '(object: WorkflowTemplatesService, method: keyof WorkflowTemplatesService): SpyInstance<Promise<void> | Promise<WorkflowTemplate> | Promise<...> | Promise<...> | Promise<...>, [dto: ...] | ... 6 more ... | [id: ...], any>', gave the following error.
        Argument of type '"getWorkflowTemplates"' is not assignable to parameter of type 'keyof WorkflowTemplatesService'.

    [7m655[0m       jest.spyOn(service, 'getWorkflowTemplates').mockRejectedValue(
    [7m   [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~[0m

    [96msrc/workflows/__tests__/workflow-templates.controller.spec.ts[0m:[93m655[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'mockRejectedValue' does not exist on type 'never'.

    [7m655[0m       jest.spyOn(service, 'getWorkflowTemplates').mockRejectedValue(
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~~[0m

FAIL modules/workspaces/workspaces.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/workspaces/workspaces.controller.spec.ts[0m:[93m309[0m:[93m26[0m - [91merror[0m[90m TS2339: [0mProperty 'ownerId' does not exist on type '{ workspaceId: string; }'.

    [7m309[0m       expect(result.data.ownerId).toBe(memberUserId);
    [7m   [0m [91m                         ~~~~~~~[0m

FAIL modules/home/home.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/home/home.integration.spec.ts[0m:[93m234[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m234[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m282[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m282[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m308[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m308[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m320[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m320[0m       const response = await request(app.getHttpServer())
    [7m   [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/home/home.integration.spec.ts[0m:[93m340[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m340[0m       await request(app.getHttpServer())
    [7m   [0m [91m            ~~~~~~~[0m

      [96msrc/modules/home/home.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL modules/auth/auth.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m24[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m24[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m41[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m41[0m       await request(app.getHttpServer())
    [7m  [0m [91m            ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m56[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m56[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m69[0m:[93m13[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m69[0m       await request(app.getHttpServer())
    [7m  [0m [91m            ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m80[0m:[93m15[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m80[0m         await request(app.getHttpServer())
    [7m  [0m [91m              ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m88[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m88[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.integration.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL modules/auth/auth.routes.spec.ts
  ● Test suite failed to run

    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m32[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m32[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m49[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m49[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m64[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m64[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m82[0m:[93m30[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m82[0m       const response = await request(app.getHttpServer())
    [7m  [0m [91m                             ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m99[0m:[93m38[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m99[0m       const registerResponse = await request(app.getHttpServer())
    [7m  [0m [91m                                     ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.
    [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m103[0m:[93m36[0m - [91merror[0m[90m TS2349: [0mThis expression is not callable.
      Type '{ default: SuperTestStatic; Test: typeof Test; agent: typeof TestAgent & ((app?: App, options?: AgentOptions) => TestAgent<Test>); }' has no call signatures.

    [7m103[0m       const signupResponse = await request(app.getHttpServer())
    [7m   [0m [91m                                   ~~~~~~~[0m

      [96msrc/modules/auth/auth.routes.spec.ts[0m:[93m3[0m:[93m1[0m
        [7m3[0m import * as request from 'supertest';
        [7m [0m [96m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        Type originates at this import. A namespace-style import cannot be called or constructed, and will cause a failure at runtime. Consider using a default import or import require here instead.

FAIL modules/projects/projects.controller.spec.ts
  ● Test suite failed to run

    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m50[0m:[93m20[0m - [91merror[0m[90m TS2740: [0mType '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m50[0m         projects: [mockProject],
    [7m  [0m [91m                   ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m100[0m:[93m72[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m100[0m       jest.spyOn(projectsService, 'findProjectById').mockResolvedValue(mockProject);
    [7m   [0m [91m                                                                       ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m170[0m:[93m70[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m170[0m       jest.spyOn(projectsService, 'createProject').mockResolvedValue(mockProject);
    [7m   [0m [91m                                                                     ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m204[0m:[93m72[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ id: string; name: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m204[0m       jest.spyOn(projectsService, 'findProjectById').mockResolvedValue(mockProject);
    [7m   [0m [91m                                                                       ~~~~~~~~~~~[0m
    [96msrc/modules/projects/projects.controller.spec.ts[0m:[93m205[0m:[93m70[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ name: string; id: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is not assignable to parameter of type 'Project | Promise<Project>'.
      Type '{ name: string; id: string; workspaceId: string; organizationId: string; status: string; createdAt: Date; updatedAt: Date; }' is missing the following properties from type 'Project': description, priority, startDate, endDate, and 24 more.

    [7m205[0m       jest.spyOn(projectsService, 'updateProject').mockResolvedValue({ ...mockProject, name: 'Updated' });
    [7m   [0m [91m                                                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL modules/work-items/my-work.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m82[0m:[93m5[0m - [91merror[0m[90m TS2740: [0mType 'User[]' is missing the following properties from type 'User': id, email, password, firstName, and 20 more.

    [7m82[0m     adminUser = await userRepo.save(
    [7m  [0m [91m    ~~~~~~~~~[0m
    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m83[0m:[93m16[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<User>[]): User[]', gave the following error.
        Object literal may only specify known properties, and 'email' does not exist in type 'DeepPartial<User>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<User>): User', gave the following error.
        Object literal may only specify known properties, and 'platformRole' does not exist in type 'DeepPartial<User>'.

    [7m83[0m       userRepo.create({
    [7m  [0m [91m               ~~~~~~[0m

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m92[0m:[93m5[0m - [91merror[0m[90m TS2740: [0mType 'User[]' is missing the following properties from type 'User': id, email, password, firstName, and 20 more.

    [7m92[0m     memberUser = await userRepo.save(
    [7m  [0m [91m    ~~~~~~~~~~[0m
    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m93[0m:[93m16[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<User>[]): User[]', gave the following error.
        Object literal may only specify known properties, and 'email' does not exist in type 'DeepPartial<User>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<User>): User', gave the following error.
        Object literal may only specify known properties, and 'platformRole' does not exist in type 'DeepPartial<User>'.

    [7m93[0m       userRepo.create({
    [7m  [0m [91m               ~~~~~~[0m

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m102[0m:[93m5[0m - [91merror[0m[90m TS2740: [0mType 'User[]' is missing the following properties from type 'User': id, email, password, firstName, and 20 more.

    [7m102[0m     guestUser = await userRepo.save(
    [7m   [0m [91m    ~~~~~~~~~[0m
    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m103[0m:[93m16[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<User>[]): User[]', gave the following error.
        Object literal may only specify known properties, and 'email' does not exist in type 'DeepPartial<User>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<User>): User', gave the following error.
        Object literal may only specify known properties, and 'platformRole' does not exist in type 'DeepPartial<User>'.

    [7m103[0m       userRepo.create({
    [7m   [0m [91m               ~~~~~~[0m

    [96msrc/modules/work-items/my-work.integration.spec.ts[0m:[93m133[0m:[93m18[0m - [91merror[0m[90m TS2769: [0mNo overload matches this call.
      Overload 1 of 3, '(entityLikeArray: DeepPartial<WorkspaceMember>[]): WorkspaceMember[]', gave the following error.
        Object literal may only specify known properties, and 'workspaceId' does not exist in type 'DeepPartial<WorkspaceMember>[]'.
      Overload 2 of 3, '(entityLike: DeepPartial<WorkspaceMember>): WorkspaceMember', gave the following error.
        Object literal may only specify known properties, and 'organizationId' does not exist in type 'DeepPartial<WorkspaceMember>'.

    [7m133[0m       memberRepo.create({
    [7m   [0m [91m                 ~~~~~~[0m

FAIL brd/services/__tests__/brd.service.spec.ts
  ● Test suite failed to run

    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m26[0m:[93m5[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'isEditable' does not exist in type 'BRD'.

    [7m26[0m     isEditable: jest.fn(),
    [7m  [0m [91m    ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m114[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType '{ path: string; message: string; }' is not assignable to type 'string'.

    [7m114[0m           {
    [7m   [0m [91m          ~[0m
    [7m115[0m             path: 'metadata.title',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m116[0m             message: 'Missing required field: title',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m117[0m           },
    [7m   [0m [91m~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m139[0m:[93m15[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m139[0m       mockBRD.isEditable = jest.fn().mockReturnValue(true);
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m147[0m:[93m41[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ version: number; payload: { metadata: { title: string; summary: string; industry: string; department: string; priority: string; version: string; author: string; stakeholders: string[]; approvalDate: string; }; ... 4 more ...; timeline: { ...; }; }; ... 7 more ...; analyses: BRDAnalysis[]; }' is not assignable to parameter of type '(DeepPartial<BRD> & BRD) | Promise<DeepPartial<BRD> & BRD>'.
      Type '{ version: number; payload: { metadata: { title: string; summary: string; industry: string; department: string; priority: string; version: string; author: string; stakeholders: string[]; approvalDate: string; }; ... 4 more ...; timeline: { ...; }; }; ... 7 more ...; analyses: BRDAnalysis[]; }' is not assignable to type '{ id?: string; organizationId?: string; project_id?: string; version?: number; status?: DeepPartial<BRDStatus>; payload?: DeepPartial<Record<string, any>>; ... 13 more ...; updateSearchVector?: DeepPartial<...>; } & BRD'.
        Type '{ version: number; payload: { metadata: { title: string; summary: string; industry: string; department: string; priority: string; version: string; author: string; stakeholders: string[]; approvalDate: string; }; ... 4 more ...; timeline: { ...; }; }; ... 7 more ...; analyses: BRDAnalysis[]; }' is missing the following properties from type 'BRD': getTitle, getSummary, getIndustry, getDepartment, and 6 more.

    [7m147[0m       repository.save.mockResolvedValue(updatedBRD);
    [7m   [0m [91m                                        ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m154[0m:[93m22[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m154[0m       expect(mockBRD.isEditable).toHaveBeenCalled();
    [7m   [0m [91m                     ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m177[0m:[93m15[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m177[0m       mockBRD.isEditable = jest.fn().mockReturnValue(false);
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m188[0m:[93m15[0m - [91merror[0m[90m TS2339: [0mProperty 'isEditable' does not exist on type 'BRD'.

    [7m188[0m       mockBRD.isEditable = jest.fn().mockReturnValue(true);
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m192[0m:[93m18[0m - [91merror[0m[90m TS2322: [0mType '{ path: string; message: string; }' is not assignable to type 'string'.

    [7m192[0m         errors: [{ path: 'metadata.title', message: 'Missing required field: title' }],
    [7m   [0m [91m                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m252[0m:[93m41[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: BRDStatus.APPROVED; id: string; organizationId: string; project_id: string | null; version: number; payload: Record<string, any>; search_vector: string | null; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is not assignable to parameter of type '(DeepPartial<BRD> & BRD) | Promise<DeepPartial<BRD> & BRD>'.
      Type '{ status: BRDStatus.APPROVED; id: string; organizationId: string; project_id: string | null; version: number; payload: Record<string, any>; search_vector: string | null; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is not assignable to type '{ id?: string; organizationId?: string; project_id?: string; version?: number; status?: DeepPartial<BRDStatus>; payload?: DeepPartial<Record<string, any>>; ... 13 more ...; updateSearchVector?: DeepPartial<...>; } & BRD'.
        Type '{ status: BRDStatus.APPROVED; id: string; organizationId: string; project_id: string; version: number; payload: Record<string, any>; search_vector: string; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is missing the following properties from type 'BRD': getTitle, getSummary, getIndustry, getDepartment, and 6 more.

    [7m252[0m       repository.save.mockResolvedValue({ ...mockBRD, status: BRDStatus.APPROVED });
    [7m   [0m [91m                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m254[0m:[93m65[0m - [91merror[0m[90m TS2554: [0mExpected 2 arguments, but got 3.

    [7m254[0m       await service.publish(mockBRD.id, mockBRD.organizationId, publishDto);
    [7m   [0m [91m                                                                ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m268[0m:[93m72[0m - [91merror[0m[90m TS2554: [0mExpected 2 arguments, but got 3.

    [7m268[0m       await expect(service.publish(mockBRD.id, mockBRD.organizationId, publishDto)).rejects.toThrow(
    [7m   [0m [91m                                                                       ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m280[0m:[93m18[0m - [91merror[0m[90m TS2322: [0mType '{ path: string; message: string; }' is not assignable to type 'string'.

    [7m280[0m         errors: [{ path: 'metadata.title', message: 'Missing required field: title' }],
    [7m   [0m [91m                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m285[0m:[93m72[0m - [91merror[0m[90m TS2554: [0mExpected 2 arguments, but got 3.

    [7m285[0m       await expect(service.publish(mockBRD.id, mockBRD.organizationId, publishDto)).rejects.toThrow(
    [7m   [0m [91m                                                                       ~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m307[0m:[93m44[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: BRDStatus; id: string; organizationId: string; project_id: string | null; version: number; payload: Record<string, any>; search_vector: string | null; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is not assignable to parameter of type 'BRD | Promise<BRD>'.
      Type '{ status: BRDStatus; id: string; organizationId: string; project_id: string; version: number; payload: Record<string, any>; search_vector: string; created_at: Date; updated_at: Date; analyses: BRDAnalysis[]; }' is missing the following properties from type 'BRD': getTitle, getSummary, getIndustry, getDepartment, and 6 more.

    [7m307[0m       repository.findOne.mockResolvedValue(publishedBRD);
    [7m   [0m [91m                                           ~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m335[0m:[93m53[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ where: jest.Mock<any, any, any>; andWhere: jest.Mock<any, any, any>; getCount: jest.Mock<any, any, any>; skip: jest.Mock<any, any, any>; take: jest.Mock<any, any, any>; orderBy: jest.Mock<...>; getMany: jest.Mock<...>; }' is not assignable to parameter of type 'SelectQueryBuilder<BRD>'.
      Type '{ where: Mock<any, any, any>; andWhere: Mock<any, any, any>; getCount: Mock<any, any, any>; skip: Mock<any, any, any>; take: Mock<any, any, any>; orderBy: Mock<...>; getMany: Mock<...>; }' is missing the following properties from type 'SelectQueryBuilder<BRD>': "@instanceof", findOptions, selects, joins, and 135 more.

    [7m335[0m       repository.createQueryBuilder.mockReturnValue(mockQueryBuilder);
    [7m   [0m [91m                                                    ~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m371[0m:[93m62[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ isValid: boolean; errorCount: number; errorsBySection: {}; missingRequiredFields: any[]; }' is not assignable to parameter of type 'ValidationSummary'.
      Type '{ isValid: boolean; errorCount: number; errorsBySection: {}; missingRequiredFields: any[]; }' is missing the following properties from type 'ValidationSummary': totalFields, completedFields, completionPercentage, missingRequired, validationErrors

    [7m371[0m       validationService.getValidationSummary.mockReturnValue(mockSummary);
    [7m   [0m [91m                                                             ~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m389[0m:[93m30[0m - [91merror[0m[90m TS2339: [0mProperty 'getSchema' does not exist on type 'BRDService'.

    [7m389[0m       const result = service.getSchema();
    [7m   [0m [91m                             ~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m407[0m:[93m53[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ where: jest.Mock<any, any, any>; andWhere: jest.Mock<any, any, any>; orderBy: jest.Mock<any, any, any>; skip: jest.Mock<any, any, any>; take: jest.Mock<any, any, any>; getMany: jest.Mock<...>; }' is not assignable to parameter of type 'SelectQueryBuilder<BRD>'.
      Type '{ where: Mock<any, any, any>; andWhere: Mock<any, any, any>; orderBy: Mock<any, any, any>; skip: Mock<any, any, any>; take: Mock<any, any, any>; getMany: Mock<...>; }' is missing the following properties from type 'SelectQueryBuilder<BRD>': "@instanceof", findOptions, selects, joins, and 136 more.

    [7m407[0m       repository.createQueryBuilder.mockReturnValue(mockQueryBuilder);
    [7m   [0m [91m                                                    ~~~~~~~~~~~~~~~~[0m
    [96msrc/brd/services/__tests__/brd.service.spec.ts[0m:[93m414[0m:[93m85[0m - [91merror[0m[90m TS2554: [0mExpected 2-3 arguments, but got 4.

    [7m414[0m       const result = await service.search('organization-id', 'customer portal', 10, 0);
    [7m   [0m [91m                                                                                    ~[0m

FAIL ai/__tests__/document-parser.service.spec.ts
  ● Test suite failed to run

    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m35[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m35[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m45[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m45[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m55[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m55[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m66[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m66[0m       } as Express.Multer.File;
    [7m  [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m122[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m122[0m       } as Express.Multer.File;
    [7m   [0m [91m                   ~~~~~~[0m
    [96msrc/ai/__tests__/document-parser.service.spec.ts[0m:[93m132[0m:[93m20[0m - [91merror[0m[90m TS2694: [0mNamespace 'global.Express' has no exported member 'Multer'.

    [7m132[0m       } as Express.Multer.File;
    [7m   [0m [91m                   ~~~~~~[0m

FAIL ./app.module.compile.spec.ts
  ● Test suite failed to run

    [96msrc/app.module.compile.spec.ts[0m:[93m10[0m:[93m28[0m - [91merror[0m[90m TS2307: [0mCannot find module './modules/projects/entities/team-member.entity' or its corresponding type declarations.

    [7m10[0m import { TeamMember } from './modules/projects/entities/team-member.entity';
    [7m  [0m [91m                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/app.module.compile.spec.ts[0m:[93m11[0m:[93m22[0m - [91merror[0m[90m TS2307: [0mCannot find module './modules/projects/entities/role.entity' or its corresponding type declarations.

    [7m11[0m import { Role } from './modules/projects/entities/role.entity';
    [7m  [0m [91m                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/app.module.compile.spec.ts[0m:[93m18[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module './pm/entities/portfolio.entity' or its corresponding type declarations.

    [7m18[0m import { Portfolio } from './pm/entities/portfolio.entity';
    [7m  [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/app.module.compile.spec.ts[0m:[93m19[0m:[93m25[0m - [91merror[0m[90m TS2307: [0mCannot find module './pm/entities/program.entity' or its corresponding type declarations.

    [7m19[0m import { Program } from './pm/entities/program.entity';
    [7m  [0m [91m                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL modules/dashboards/dashboards-mutations.integration.spec.ts
  ● Test suite failed to run

    [96msrc/modules/dashboards/dashboards-mutations.integration.spec.ts[0m:[93m37[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/dashboard.entity' or its corresponding type declarations.

    [7m37[0m import { Dashboard } from '../entities/dashboard.entity';
    [7m  [0m [91m                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/dashboards/dashboards-mutations.integration.spec.ts[0m:[93m38[0m:[93m33[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/dashboard-widget.entity' or its corresponding type declarations.

    [7m38[0m import { DashboardWidget } from '../entities/dashboard-widget.entity';
    [7m  [0m [91m                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/modules/dashboards/dashboards-mutations.integration.spec.ts[0m:[93m39[0m:[93m37[0m - [91merror[0m[90m TS2307: [0mCannot find module '../entities/dashboard.entity' or its corresponding type declarations.

    [7m39[0m import { DashboardVisibility } from '../entities/dashboard.entity';
    [7m  [0m [91m                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL modules/rollups/rollups-phase6-closeout.integration.spec.ts (9.69 s)
  ● Phase 6 Closeout Integration Tests › Module C.1: Member access boundaries › Member with access to workspace A only cannot read workspace B portfolios, programs, rollups. Expect 404

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.2: Guest read-only access › Guest with access to workspace A can read lists and rollups for A. Cannot write. Expect 403 Forbidden

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.3: Admin-only create › Admin can create portfolio and program in workspace A. Member cannot. Expect 403 Forbidden

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4a. Admin links project to program. portfolioId is auto set from program

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4b. Admin links project to portfolio only. programId stays null

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4c. Admin tries to link project to program from another workspace. Expect 404 or BadRequest, no leak

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4d. Admin provides programId and mismatched portfolioId. Expect 400

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.4: Linking scenarios › 4e. Admin unlinks. programId and portfolioId both null

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.5: Rollup accuracy › 5a. Program rollup totals match seeded data

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

  ● Phase 6 Closeout Integration Tests › Module C.5: Rollup accuracy › 5b. Portfolio rollup totals match seeded data

    QueryFailedError: null value in column "slug" of relation "organizations" violates not-null constraint

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at DataSource.query (data-source/DataSource.ts:538:20)
      at setupTestData (modules/rollups/rollups-phase6-closeout.integration.spec.ts:110:23)
      at Object.<anonymous> (modules/rollups/rollups-phase6-closeout.integration.spec.ts:75:5)

FAIL modules/work-items/work-items-bulk.integration.spec.ts (10.444 s)
  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 1. Guest bulk update blocked

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 2. Member bulk update allowed in own workspace

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 3. Member bulk update cannot cross workspace

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 4. Admin bulk update can operate across workspaces when access exists

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 5. Validation: ids max 200 enforced

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 6. Cross project ID mixing blocked

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/update › 7. Status transition validation applies per item

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/delete › 8. Member bulk delete forbidden

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/delete › 9. Admin bulk delete allowed and scoped

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

  ● Work Items Bulk Actions (e2e) › POST /work-items/bulk/delete › 10. Non-member gets 404

    QueryFailedError: column "key" of relation "work_items" does not exist

      at PostgresQueryRunner.query (driver/postgres/PostgresQueryRunner.ts:331:19)
      at InsertQueryBuilder.execute (query-builder/InsertQueryBuilder.ts:163:33)
      at SubjectExecutor.executeInsertOperations (persistence/SubjectExecutor.ts:435:42)
      at SubjectExecutor.execute (persistence/SubjectExecutor.ts:137:9)
      at EntityPersistExecutor.execute (persistence/EntityPersistExecutor.ts:182:21)
      at setupTestData (modules/work-items/work-items-bulk.integration.spec.ts:290:21)
      at Object.<anonymous> (modules/work-items/work-items-bulk.integration.spec.ts:88:5)

FAIL modules/rollups/rollups.integration.spec.ts (13.701 s)
  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 1: Member with access to workspace A only - call program rollup in workspace A, gets 200

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 2: Member with access to workspace A only - call program rollup in workspace B, gets 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 3: Program rollup counts are workspace scoped - work items in workspace B do not affect workspace A rollup

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Program Rollup › Test 4: Non existent programId in workspace A returns 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Portfolio Rollup › Test 5: Member with access to workspace A only - portfolio rollup in workspace B, gets 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Portfolio Rollup › Test 6: Admin - portfolio rollup returns totals that match created fixtures

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)

  ● Rollups Integration Tests (Phase 6 Module 4) › Portfolio Rollup › Test 7: Non existent portfolioId in workspace A returns 404

    thrown: "Exceeded timeout of 5000 ms for a hook.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      36 |   let workItemB1Id: string;
      37 |
    > 38 |   beforeAll(async () => {
         |   ^
      39 |     const moduleFixture: TestingModule = await Test.createTestingModule({
      40 |       imports: [AppModule],
      41 |     }).compile();

      at modules/rollups/rollups.integration.spec.ts:38:3
      at Object.<anonymous> (modules/rollups/rollups.integration.spec.ts:16:1)


Test Suites: 29 failed, 23 passed, 52 total
Tests:       86 failed, 201 passed, 287 total
Snapshots:   0 total
Time:        15.019 s
Ran all test suites.
