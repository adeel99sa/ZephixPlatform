#!/bin/bash
# Phase 3C Manual Smoke Test Script
set -e

echo "üîê Zephix Dashboards Phase 3C - Manual Smoke Test"
echo "================================================"

echo "üöÄ Manual smoke test checklist:"
echo ""
echo "Please perform these steps manually in your browser:"
echo ""

echo "1Ô∏è‚É£ Create dashboard ‚Üí builder opens ‚Üí add Note ‚Üí autosave ‚Üí 'saved'"
echo "   ‚Ä¢ Navigate to /dashboards"
echo "   ‚Ä¢ Click 'Create Dashboard'"
echo "   ‚Ä¢ Fill form and submit"
echo "   ‚Ä¢ Verify builder opens"
echo "   ‚Ä¢ Add a Note widget"
echo "   ‚Ä¢ Verify autosave shows 'saved' status"
echo ""

echo "2Ô∏è‚É£ Force conflict: open same dashboard in two tabs, edit both ‚Üí second sees 'conflict'"
echo "   ‚Ä¢ Open dashboard in two browser tabs"
echo "   ‚Ä¢ Edit widget in first tab"
echo "   ‚Ä¢ Edit widget in second tab"
echo "   ‚Ä¢ Verify second tab shows 'conflict' banner with reload button"
echo ""

echo "3Ô∏è‚É£ Duplicate ‚Üí lands on new ID, switcher lists both"
echo "   ‚Ä¢ In builder, click 'More' menu"
echo "   ‚Ä¢ Click 'Duplicate' (if FF_DASHBOARD_DUPLICATE enabled)"
echo "   ‚Ä¢ Verify navigation to new dashboard ID"
echo "   ‚Ä¢ Verify dashboard switcher shows both dashboards"
echo ""

echo "4Ô∏è‚É£ Delete ‚Üí goes to Trash ‚Üí Restore ‚Üí shows back in switcher"
echo "   ‚Ä¢ In builder, click 'More' menu"
echo "   ‚Ä¢ Click 'Delete' (if FF_DASHBOARD_DELETE enabled)"
echo "   ‚Ä¢ Confirm deletion"
echo "   ‚Ä¢ Navigate to /admin/trash"
echo "   ‚Ä¢ Verify deleted dashboard appears"
echo "   ‚Ä¢ Click 'Restore'"
echo "   ‚Ä¢ Verify dashboard appears back in switcher"
echo ""

echo "5Ô∏è‚É£ Filters: set tr=7d ‚Üí URL contains tr=7d ‚Üí navigate away/back ‚Üí URL persists"
echo "   ‚Ä¢ Navigate to /dashboards/:id"
echo "   ‚Ä¢ Set time range filter to '7d'"
echo "   ‚Ä¢ Click 'Apply'"
echo "   ‚Ä¢ Verify URL contains 'tr=7d'"
echo "   ‚Ä¢ Navigate to /home"
echo "   ‚Ä¢ Navigate back to dashboard"
echo "   ‚Ä¢ Verify URL still contains 'tr=7d'"
echo ""

echo "6Ô∏è‚É£ Export ‚Üí filename = '<dashboard name>.csv'"
echo "   ‚Ä¢ In dashboard view, click 'Export'"
echo "   ‚Ä¢ Verify download starts"
echo "   ‚Ä¢ Verify filename contains dashboard name"
echo ""

echo "7Ô∏è‚É£ Share visibility ‚Üí workspace/org/private ‚Üí Save ‚Üí telemetry emitted"
echo "   ‚Ä¢ In dashboard view, click 'Share'"
echo "   ‚Ä¢ Change visibility to 'org'"
echo "   ‚Ä¢ Click 'Save'"
echo "   ‚Ä¢ Verify dialog closes"
echo "   ‚Ä¢ Check browser console for telemetry events"
echo ""

echo "‚úÖ Manual smoke test completed!"
echo ""
echo "If all steps pass, Phase 3C is ready for production deployment."
